<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="es" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introducción a la computación de alto rendimiento: Todo en una sola página</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/cp/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicons/cp/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicons/cp/favicon-16x16.png">
<link rel="manifest" href="../favicons/cp/site.webmanifest">
<link rel="mask-icon" href="../favicons/cp/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav carpentries"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Ir al contenido principal</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="cp-logo" alt="Lesson Description" src="../assets/images/carpentries-logo.svg"><span class="badge text-bg-warning">
          <abbr title="Esta lección se encuentra en la fase alfa, lo que significa que se ha enseñado una vesy las autoras de la lección están trabajando en los comentarios.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
              Alfa
            </a>
            <span class="visually-hidden">Esta lección se encuentra en la fase alfa, lo que significa que se ha enseñado una vesy las autoras de la lección están trabajando en los comentarios.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Vista de la instructora <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Vista de estudiante</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav carpentries" aria-label="Navegación principal"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Alternar navegación">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menú</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="../assets/images/carpentries-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introducción a la computación de alto rendimiento
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Buscar en la página All In One" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introducción a la computación de alto rendimiento
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Puntos Clave</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Notas de la instructora</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extraer todas las imágenes</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            Más <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="learner-prerequisites.html">Learner Prerequisites</a></li>
<li><a class="dropdown-item" href="learner-profiles.html">Learner Profiles</a></li>
<hr>
<li><a class="dropdown-item" href="discuss.html">Taking Your Next Steps</a></li>
<li><a class="dropdown-item" href="reference.html">Knowledge Base</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Buscar en la página All In One"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Buscar en la página All In One">Buscar en la página All In One</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introducción a la computación de alto rendimiento
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress carpentries">
    <div class="progress-bar carpentries" role="progressbar" style="width: %" aria-valuenow="" aria-label="Progreso de la lección" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="Cerrar menú" alt="Cerrar menú" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Cerrar " data-episodes="Episodios ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Vista de la instructora
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Vista de estudiante</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODIOS
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Resumen y agenda</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="10-hpc-intro.html">1. ¿Por qué utilizar un clúster?</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="11-connecting.html">2. Conexión a un sistema HPC remoto</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="12-cluster.html">3. Trabajar en un sistema HPC remoto</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="13-scheduler.html">4. Fundamentos del programador</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="14-environment-variables.html">5. Variables de entorno</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="15-modules.html">6. Acceso al software a través de módulos</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="16-transferring-files.html">7. Transferencia de archivos con ordenadores remotos</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="17-parallel.html">8. Ejecutar un trabajo paralelo</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="18-resources.html">9. Uso eficaz de los recursos</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="19-responsibility.html">10. Uso responsable de los recursos compartidos</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RECURSOS
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Puntos Clave</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Notas de la instructora</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extraer todas las imágenes</a>
                      </li>
                      <li><a href="learner-prerequisites.html">Learner Prerequisites</a></li>
<li><a href="learner-profiles.html">Learner Profiles</a></li>
<hr>
<li><a class="dropdown-item" href="discuss.html">Taking Your Next Steps</a></li>
<li><a class="dropdown-item" href="reference.html">Knowledge Base</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">Todo en una sola página</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-10-hpc-intro"><p>Content from <a href="10-hpc-intro.html">¿Por qué utilizar un clúster?</a></p>
<hr>
<p>Última actualización: 2025-08-04 |

        <a href="https://github.com/ocaisa/probable-pancake/edit/main/episodes/10-hpc-intro.md" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Tiempo estimado: <i aria-hidden="true" data-feather="clock"></i> 20 minutos</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Por qué me interesa la computación de alto rendimiento (HPC)?</li>
<li>¿Qué puedo esperar aprender de este curso?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<ul>
<li>Describa qué es un sistema HPC</li>
<li>Identifique cómo podría beneficiarle un sistema HPC.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Con frecuencia, los problemas de investigación que utilizan la
computación pueden superar las capacidades del ordenador de sobremesa o
portátil en el que comenzaron:</p>
<ul>
<li>Un estudiante de estadística quiere validar un modelo de forma
cruzada. Para ello, debe ejecutar el modelo 1.000 veces, pero cada
ejecución tarda una hora. Ejecutar el modelo en un ordenador portátil
llevaría más de un mes En este problema de investigación, los resultados
finales se calculan después de ejecutar los 1000 modelos, pero
normalmente sólo se ejecuta un modelo a la vez (en
<strong>serie</strong>) en el portátil. Dado que cada una de las 1000
ejecuciones es independiente de las demás, y si se dispone de
suficientes ordenadores, en teoría es posible ejecutarlas todas a la vez
(en <strong>paralelo</strong>).</li>
<li>Un investigador en genómica ha estado utilizando pequeños conjuntos
de datos de secuenciación, pero pronto recibirá un nuevo tipo de datos
de secuenciación que es 10 veces más grande. Abrir los conjuntos de
datos en un ordenador ya supone un reto; analizar estos conjuntos de
datos más grandes probablemente lo colapsará. En este problema de
investigación, los cálculos necesarios podrían ser imposibles de
paralelizar, pero se necesitaría un ordenador con <strong>más
memoria</strong> para analizar el futuro conjunto de datos mucho
mayor.</li>
<li>Un ingeniero está utilizando un paquete de dinámica de fluidos que
tiene una opción para ejecutarse en paralelo. Hasta ahora, esta opción
no se utilizaba en un ordenador de sobremesa. Al pasar de simulaciones
2D a 3D, el tiempo de simulación se ha más que triplicado. Podría ser
útil aprovechar esa opción o característica. En este problema de
investigación, los cálculos en cada región de la simulación son en gran
medida independientes de los cálculos en otras regiones de la
simulación. Es posible ejecutar los cálculos de cada región
simultáneamente (en <strong>paralelo</strong>), comunicar los resultados
seleccionados a las regiones adyacentes según sea necesario y repetir
los cálculos para converger en un conjunto final de resultados. Al pasar
de un modelo 2D a un modelo 3D, <strong>tanto la cantidad de datos como
la cantidad de cálculos aumentan enormemente</strong>, y en teoría es
posible distribuir los cálculos entre varios ordenadores que se
comunican a través de una red compartida.</li>
</ul>
<p>En todos estos casos, se necesita acceso a más ordenadores (y más
grandes). Esos ordenadores deben poder utilizarse al mismo tiempo,
<strong>resolviendo en paralelo los problemas de muchos
investigadores</strong>.</p>
<section><h2 class="section-heading" id="presentación-de-jargon-busting">Presentación de Jargon Busting<a class="anchor" aria-label="anchor" href="#presentaci%C3%B3n-de-jargon-busting"></a>
</h2>
<hr class="half-width">
<p>Abra el <a href="../files/jargon#p1">HPC Jargon Buster</a> en una nueva
pestaña. Para presentar el contenido, pulse <code>C</code> para abrir un
<strong>c</strong>lone en una ventana separada, después pulse
<code>P</code> para cambiar el modo de
<strong>p</strong>resentación.</p>
<div id="nunca-he-usado-un-servidor-verdad" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="nunca-he-usado-un-servidor-verdad" class="callout-inner">
<h3 class="callout-title">Nunca he usado un servidor, ¿verdad?</h3>
<div class="callout-content">
<p>Tómese un minuto y piense cuáles de sus interacciones diarias con un
ordenador pueden requerir un servidor remoto o incluso un clúster para
proporcionarle resultados.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Algunas ideas
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ul>
<li>Comprobación del correo electrónico: su ordenador (posiblemente en
el bolsillo) se pone en contacto con una máquina remota, se autentica y
descarga una lista de mensajes nuevos; también carga los cambios en el
estado del mensaje, como si lo ha leído, marcado como basura o borrado.
Como la suya no es la única cuenta, el servidor de correo es
probablemente uno de tantos en un centro de datos.</li>
<li>Buscar una frase en Internet implica comparar el término de búsqueda
con una base de datos masiva de todos los sitios conocidos, en busca de
coincidencias. Esta operación de “consulta” puede ser sencilla, pero
construir esa base de datos es una <a href="https://en.wikipedia.org/wiki/MapReduce" class="external-link">tarea monumental</a> Los
servidores intervienen en cada paso.</li>
<li>Buscar direcciones en un sitio web de mapas implica conectar los
puntos (A) inicial y (B) final <a href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm" class="external-link">recorriendo
un grafo</a> en busca del camino “más corto” por distancia, tiempo,
gasto u otra métrica. Convertir un mapa en la forma correcta es
relativamente sencillo, pero calcular todas las rutas posibles entre A y
B es costoso.</li>
</ul>
<p>Consultar el correo electrónico podría ser en serie: su máquina se
conecta a un servidor e intercambia datos. La búsqueda en la base de
datos del término de búsqueda (o puntos finales) también podría ser en
serie, ya que una máquina recibe la consulta y devuelve el resultado.
Sin embargo, montar y almacenar la base de datos completa supera con
creces la capacidad de una sola máquina. Por lo tanto, estas funciones
se realizan en paralelo mediante una gran colección de servidores
[“hiperescala”][hiperescala] que trabajan juntos.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul>
<li>La computación de alto rendimiento (HPC) suele implicar la conexión
a sistemas informáticos muy grandes de otras partes del mundo.</li>
<li>Estos otros sistemas pueden utilizarse para realizar tareas que
serían imposibles o mucho más lentas en sistemas más pequeños.</li>
<li>Los recursos HPC son compartidos por múltiples usuarios.</li>
<li>El método estándar de interacción con estos sistemas es a través de
una interfaz de línea de comandos.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-11-connecting"><p>Content from <a href="11-connecting.html">Conexión a un sistema HPC remoto</a></p>
<hr>
<p>Última actualización: 2025-08-04 |

        <a href="https://github.com/ocaisa/probable-pancake/edit/main/episodes/11-connecting.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Tiempo estimado: <i aria-hidden="true" data-feather="clock"></i> 35 minutos</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo me conecto a un sistema HPC remoto?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<ul>
<li>Configure el acceso seguro a un sistema HPC remoto.</li>
<li>Conéctate a un sistema HPC remoto.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="conexiones-seguras">Conexiones seguras<a class="anchor" aria-label="anchor" href="#conexiones-seguras"></a>
</h2>
<hr class="half-width">
<p>El primer paso para utilizar un cluster es establecer una conexión
desde nuestro portátil al cluster. Cuando estamos sentados frente a un
ordenador (o de pie, o sosteniéndolo en nuestras manos o en nuestras
muñecas), hemos llegado a esperar una pantalla visual con iconos,
widgets, y quizás algunas ventanas o aplicaciones: una <em>interfaz
gráfica de usuario</em>, o GUI. Dado que los clusters de ordenadores son
recursos remotos a los que nos conectamos a través de interfaces lentas
o intermitentes (WiFi y VPNs especialmente), es más práctico usar una
<em>interfaz de línea de comandos</em>, o CLI, para enviar comandos como
texto plano. Si un comando devuelve una salida, también se imprime como
texto plano. Los comandos que ejecutaremos hoy no abrirán una ventana
para mostrar resultados gráficos.</p>
<p>Si alguna vez has abierto el Símbolo del sistema de Windows o el
Terminal de macOS, habrás visto una CLI. Si ya has tomado los cursos de
The Carpentries sobre UNIX Shell o Version Control, has usado el CLI en
tu <em>máquina local</em> extensivamente. El único salto a dar aquí es
abrir un CLI en una <em>máquina remota</em>, tomando algunas
precauciones para que otras personas en la red no puedan ver (o cambiar)
los comandos que estás ejecutando o los resultados que la máquina remota
envía de vuelta. Utilizaremos el protocolo Secure SHell (o SSH) para
abrir una conexión de red encriptada entre dos máquinas, permitiéndote
enviar y recibir texto y datos sin tener que preocuparte de miradas
indiscretas.</p>
<figure><img src="../fig/connect-to-remote.svg" max-width="50%" alt="Conectarse al clúster" class="figure mx-auto d-block"></figure><p>Los clientes SSH suelen ser herramientas de línea de comandos en las
que el único argumento necesario es la dirección de la máquina remota.
Si tu nombre de usuario en el sistema remoto difiere del que utilizas
localmente, debes proporcionarlo también. Si tu cliente SSH tiene un
front-end gráfico, como PuTTY o MobaXterm, establecerás estos argumentos
antes de hacer clic en “conectar” Desde el terminal, escribirás algo
como <code>ssh userName@hostname</code>, donde el argumento es igual que
una dirección de correo electrónico: el símbolo “@” se utiliza para
separar el ID personal de la dirección de la máquina remota.</p>
<p>Al iniciar sesión en un ordenador portátil, tableta u otro
dispositivo personal, normalmente se requiere un nombre de usuario, una
contraseña o un patrón para evitar el acceso no autorizado. En estas
situaciones, la probabilidad de que alguien intercepte tu contraseña es
baja, ya que para registrar tus pulsaciones de teclas se requiere un
exploit malicioso o acceso físico. Para sistemas como
<code>login1</code> que ejecutan un servidor SSH, cualquiera en la red
puede iniciar sesión, o intentarlo. Dado que los nombres de usuario
suelen ser públicos o fáciles de adivinar, la contraseña suele ser el
eslabón más débil de la cadena de seguridad. Por lo tanto, muchos
clusters prohíben el inicio de sesión basado en contraseña, requiriendo
en su lugar que generes y configures un par de claves pública-privada
con una contraseña mucho más fuerte. Incluso si tu cluster no lo
requiere, la siguiente sección te guiará a través del uso de claves SSH
y un agente SSH para reforzar tu seguridad <em>y</em> hacer más
conveniente el inicio de sesión en sistemas remotos.</p>
<div class="section level3">
<h3 id="mejor-seguridad-con-claves-ssh">Mejor seguridad con claves SSH<a class="anchor" aria-label="anchor" href="#mejor-seguridad-con-claves-ssh"></a>
</h3>
<p>La <a href="index.html#setup">Lesson Setup</a> proporciona instrucciones
para instalar una aplicación shell con SSH. Si aún no lo ha hecho, abra
esa aplicación shell con una interfaz de línea de comandos tipo Unix en
su sistema.</p>
<p>Las claves SSH son un método alternativo de autenticación para
obtener acceso a sistemas informáticos remotos. También se pueden
utilizar para autenticarse al transferir archivos o para acceder a
sistemas remotos de control de versiones (como <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh" class="external-link">GitHub</a>).
En esta sección crearás un par de claves SSH:</p>
<ul>
<li>una clave privada que guardas en tu propio ordenador, y</li>
<li>una clave pública que puedes colocar en cualquier sistema remoto al
que vayas a acceder.</li>
</ul>
<div id="las-claves-privadas-son-tu-pasaporte-digital-seguro" class="callout caution">
<div class="callout-square">
<i class="callout-icon" data-feather="alert-triangle"></i>
</div>
<div id="las-claves-privadas-son-tu-pasaporte-digital-seguro" class="callout-inner">
<h3 class="callout-title">Las claves privadas son tu pasaporte digital seguro</h3>
<div class="callout-content">
<p>Una clave privada que sea visible para cualquiera excepto para ti
debe considerarse comprometida y debe ser destruida. Esto incluye tener
permisos inadecuados en el directorio en el que está almacenada (o una
copia), atravesar cualquier red que no sea segura (encriptada),
adjuntarla en un correo electrónico no encriptado, e incluso mostrar la
clave en la ventana de tu terminal.</p>
<p>Protege esta clave como si abriera la puerta de tu casa. En muchos
sentidos, lo hace.</p>
</div>
</div>
</div>
<p>Independientemente del software o sistema operativo que utilices,
<em>por favor</em> elige una contraseña o frase de contraseña segura que
actúe como otra capa de protección para tu clave SSH privada.</p>
<div id="consideraciones-sobre-las-contraseñas-de-las-claves-ssh" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="consideraciones-sobre-las-contraseñas-de-las-claves-ssh" class="callout-inner">
<h3 class="callout-title">Consideraciones sobre las contraseñas de las claves SSH</h3>
<div class="callout-content">
<p>Cuando se le solicite, introduzca una contraseña segura que pueda
recordar. Hay dos enfoques comunes para esto:</p>
<ol style="list-style-type: decimal">
<li>Crea una frase de contraseña memorable con algunos signos de
puntuación y sustituciones de números por letras, de 32 caracteres o
más. Las direcciones funcionan bien, pero ten cuidado con los ataques de
ingeniería social o de registros públicos.</li>
<li>Utiliza un gestor de contraseñas y su generador de contraseñas
integrado con todas las clases de caracteres, de 25 caracteres o más. <a href="https://keepass.info" class="external-link">KeePass</a> y <a href="https://bitwarden.com" class="external-link">BitWarden</a> son dos buenas opciones.</li>
<li>Nada es <em>menos</em> seguro que una clave privada sin contraseña.
Si se ha saltado la introducción de la contraseña por accidente, vuelva
atrás y genere un nuevo par de claves <em>con</em> una contraseña
segura.</li>
</ol>
</div>
</div>
</div>
<div class="section level4">
<h4 id="claves-ssh-en-linux-mac-mobaxterm-y-windows-subsistema-para-linux">Claves SSH en Linux, Mac, MobaXterm y Windows Subsistema para
Linux<a class="anchor" aria-label="anchor" href="#claves-ssh-en-linux-mac-mobaxterm-y-windows-subsistema-para-linux"></a>
</h4>
<p>Una vez que haya abierto un terminal, compruebe si existen claves SSH
y nombres de archivo, ya que las claves SSH existentes se
sobrescriben.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ls ~/.ssh/</span></code></pre>
</div>
<p>Si <code>~/.ssh/id_ed25519</code> ya existe, tendrá que especificar
un nombre diferente para el nuevo par de claves.</p>
<p>Genera un nuevo par de claves pública-privada usando el siguiente
comando, que producirá una clave más fuerte que la
<code>ssh-keygen</code> por defecto invocando estas banderas:</p>
<ul>
<li>
<code>-a</code> (por defecto es 16): número de rondas de derivación
de la frase de contraseña; aumentar para ralentizar los ataques de
fuerza bruta.</li>
<li>
<code>-t</code> (por defecto es <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" class="external-link">rsa</a>):
especifica el “tipo” o algoritmo criptográfico. <code>ed25519</code>
especifica <a href="https://en.wikipedia.org/wiki/EdDSA" class="external-link">EdDSA</a> con
una clave de 256 bits; es más rápido que RSA con una fuerza
comparable.</li>
<li>
<code>-f</code> (por defecto es /home/usuario/.ssh/id_algorithm):
nombre de archivo para almacenar tu clave privada. El nombre de archivo
de la clave pública será idéntico, con una extensión <code>.pub</code>
añadida.</li>
</ul>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh-keygen <span class="at">-a</span> 100 <span class="at">-f</span> ~/.ssh/id_ed25519 <span class="at">-t</span> ed25519</span></code></pre>
</div>
<p>Cuando se le solicite, introduzca una contraseña segura teniendo en
cuenta las <a href="#considerations-for-ssh-key-passwords">consideraciones
anteriores</a>. Ten en cuenta que el terminal no parecerá cambiar
mientras escribes la contraseña: esto es deliberado, por tu seguridad.
Se le pedirá que la escriba de nuevo, así que no se preocupe demasiado
por los errores tipográficos.</p>
<p>Echa un vistazo en <code>~/.ssh</code> (utiliza
<code>ls ~/.ssh</code>). Debería ver dos archivos nuevos:</p>
<ul>
<li>su clave privada (<code>~/.ssh/id_ed25519</code>): *no la compartas
con nadie</li>
<li>la clave pública compartible (<code>~/.ssh/id_ed25519.pub</code>):
si un administrador del sistema te pide una clave, ésta es la que debes
enviar. También es segura para subir a sitios web como GitHub: está
pensada para ser vista.</li>
</ul>
<div id="usar-rsa-para-sistemas-antiguos" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="usar-rsa-para-sistemas-antiguos" class="callout-inner">
<h3 class="callout-title">Usar RSA para sistemas antiguos</h3>
<div class="callout-content">
<p>Si la generación de claves falló porque ed25519 no está disponible,
intenta usar el criptosistema más antiguo (pero aún fuerte y confiable)
<a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" class="external-link">RSA</a>. De
nuevo, primero comprueba si existe una clave:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ls ~/.ssh/</span></code></pre>
</div>
<p>Si <code>~/.ssh/id_rsa</code> ya existe, tendrás que especificar
elegir un nombre diferente para el nuevo par de claves. Genérelo como
arriba, con las siguientes banderas adicionales:</p>
<ul>
<li>
<code>-b</code> establece el número de bits de la clave. El valor
predeterminado es 2048. EdDSA utiliza una longitud de clave fija, por lo
que esta bandera no tendría ningún efecto.</li>
<li>
<code>-o</code> (no por defecto): utiliza el formato de clave
OpenSSH, en lugar de PEM.</li>
</ul>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh-keygen <span class="at">-a</span> 100 <span class="at">-b</span> 4096 <span class="at">-f</span> ~/.ssh/id_rsa <span class="at">-o</span> <span class="at">-t</span> rsa</span></code></pre>
</div>
<p>Cuando se le solicite, introduzca una contraseña segura teniendo en
cuenta las <a href="#considerations-for-ssh-key-passwords">consideraciones
anteriores</a>.</p>
<p>Echa un vistazo en <code>~/.ssh</code> (utiliza
<code>ls ~/.ssh</code>). Debería ver dos archivos nuevos:</p>
<ul>
<li>su clave privada (<code>~/.ssh/id_rsa</code>): *no la compartas con
nadie</li>
<li>la clave pública compartible (<code>~/.ssh/id_rsa.pub</code>): si un
administrador del sistema te pide una clave, ésta es la que debes
enviar. También es segura para subir a sitios web como GitHub: está
pensada para ser vista.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="claves-ssh-en-putty">Claves SSH en PuTTY<a class="anchor" aria-label="anchor" href="#claves-ssh-en-putty"></a>
</h4>
<p>Si utiliza PuTTY en Windows, descargue y utilice
<code>puttygen</code> para generar el par de claves. Consulte la <a href="https://tartarus.org/~simon/putty-prerel-snapshots/htmldoc/Chapter8.html#pubkey-puttygen" class="external-link">documentación
de PuTTY</a> para más detalles.</p>
<ul>
<li>Selecciona <code>EdDSA</code> como tipo de clave.</li>
<li>Seleccione <code>255</code> como tamaño o fuerza de la clave.</li>
<li>Haz clic en el botón “Generar”.</li>
<li>No es necesario introducir un comentario.</li>
<li>Cuando se le solicite, introduzca una contraseña segura teniendo en
cuenta las <a href="#considerations-for-ssh-key-passwords">consideraciones
anteriores</a>.</li>
<li>Guarda las claves en una carpeta que ningún otro usuario del sistema
pueda leer.</li>
</ul>
<p>Echa un vistazo a la carpeta que has especificado. Debería ver dos
archivos nuevos:</p>
<ul>
<li>su clave privada (<code>id_ed25519</code>): *no la compartas con
nadie</li>
<li>la clave pública compartible (<code>id_ed25519.pub</code>): si un
administrador del sistema te pide una clave, ésta es la que debes
enviar. También es segura para subir a sitios web como GitHub: está
pensada para ser vista.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="agente-ssh-para-facilitar-el-manejo-de-claves">Agente SSH para facilitar el manejo de claves<a class="anchor" aria-label="anchor" href="#agente-ssh-para-facilitar-el-manejo-de-claves"></a>
</h3>
<p>Una clave SSH es tan fuerte como la contraseña utilizada para
desbloquearla, pero por otro lado, escribir una contraseña compleja cada
vez que te conectas a una máquina es tedioso y envejece muy rápido. Aquí
es donde entra el <a href="https://www.ssh.com/academy/ssh/agent" class="external-link">Agente
SSH</a>.</p>
<p>Usando un Agente SSH, puede escribir su contraseña para la clave
privada una vez, y luego hacer que el Agente la recuerde durante un
número de horas o hasta que cierre la sesión. A menos que algún actor
nefasto tenga acceso físico a su máquina, esto mantiene la contraseña
segura, y elimina el tedio de introducir la contraseña varias veces.</p>
<p>Recuerda tu contraseña, porque una vez que caduque en el Agente,
tendrás que escribirla de nuevo.</p>
<div class="section level4">
<h4 id="agentes-ssh-en-linux-macos-y-windows">Agentes SSH en Linux, macOS y Windows<a class="anchor" aria-label="anchor" href="#agentes-ssh-en-linux-macos-y-windows"></a>
</h4>
<p>Abre tu aplicación de terminal y comprueba si se está ejecutando un
agente:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh-add <span class="at">-l</span></span></code></pre>
</div>
<ul>
<li>
<p>Si obtiene un error como el siguiente,</p>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error connecting to agent: No such file or directory</code></pre>
</div>
<p>… entonces necesitas lanzar el agente como sigue:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> eval <span class="va">$(</span><span class="fu">ssh-agent</span><span class="va">)</span></span></code></pre>
</div>
<div id="callout3" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">¿Qué hay en
<code>$(...)</code>?</h3>
<div class="callout-content">
<p>La sintaxis de este comando de Agente SSH es inusual, basado en lo
que hemos visto en la lección de UNIX Shell. Esto es porque el comando
<code>ssh-agent</code> crea abre una conexión a la que sólo usted tiene
acceso, e imprime una serie de comandos shell que pueden ser usados para
alcanzarla – ¡pero <em>no los ejecuta!</em></p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh-agent</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>SSH_AUTH_SOCK=/tmp/ssh-Zvvga2Y8kQZN/agent.131521;
export SSH_AUTH_SOCK;
SSH_AGENT_PID=131522;
export SSH_AGENT_PID;
echo Agent pid 131522;</code></pre>
</div>
<p>El comando <code>eval</code> interpreta esta salida de texto como
comandos y le permite acceder a la conexión del Agente SSH que acaba de
crear.</p>
<p>Puede ejecutar cada línea de la salida <code>ssh-agent</code> usted
mismo y obtener el mismo resultado. El uso de <code>eval</code> facilita
las cosas.</p>
</div>
</div>
</div>
</li>
<li><p>De lo contrario, su agente ya se está ejecutando: no se meta con
él.</p></li>
</ul>
<p>Añade tu clave al agente, con expiración de sesión después de 8
horas:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh-add <span class="at">-t</span> 8h ~/.ssh/id_ed25519</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Enter passphrase for .ssh/id_ed25519:
Identity added: .ssh/id_ed25519
Lifetime set to 86400 seconds</code></pre>
</div>
<p>Mientras dure (8 horas), siempre que utilices esa clave, el Agente
SSH proporcionará la clave en tu nombre sin que tengas que teclear ni
una sola tecla.</p>
</div>
<div class="section level4">
<h4 id="agente-ssh-en-putty">Agente SSH en PuTTY<a class="anchor" aria-label="anchor" href="#agente-ssh-en-putty"></a>
</h4>
<p>Si utiliza PuTTY en Windows, descargue y utilice <code>pageant</code>
como agente SSH. Consulte la <a href="https://tartarus.org/~simon/putty-prerel-snapshots/htmldoc/Chapter9.html#pageant" class="external-link">documentación
de PuTTY</a>.</p>
</div>
</div>
<div class="section level3">
<h3 id="transfiere-tu-clave-pública">Transfiere tu clave pública<a class="anchor" aria-label="anchor" href="#transfiere-tu-clave-p%C3%BAblica"></a>
</h3>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> scp ~/.ssh/id_ed25519.pub yourUsername@cluster.hpc-carpentry.org:~/</span></code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="entrar-en-el-cluster">Entrar en el Cluster<a class="anchor" aria-label="anchor" href="#entrar-en-el-cluster"></a>
</h2>
<hr class="half-width">
<p>Abre tu terminal o cliente gráfico SSH, e inicia sesión en el
clúster. Sustituye <code>yourUsername</code> por tu nombre de usuario o
el suministrado por los instructores.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh yourUsername@cluster.hpc-carpentry.org</span></code></pre>
</div>
<p>Es posible que se te pida la contraseña. Atención: los caracteres que
escriba después de la solicitud de contraseña no se mostrarán en
pantalla. La salida normal se reanudará cuando pulse
<code>Enter</code>.</p>
<p>Puede que haya notado que el prompt cambió cuando se conectó al
sistema remoto usando el terminal (si se conectó usando PuTTY esto no se
aplicará porque no ofrece un terminal local). Este cambio es importante
porque puede ayudarte a distinguir en qué sistema se ejecutarán los
comandos que escribas cuando los pases a la terminal. Este cambio es
también una pequeña complicación que tendremos que sortear a lo largo
del taller. Exactamente lo que se muestra como prompt (que
convencionalmente termina en <code>$</code>) en la terminal cuando está
conectada al sistema local y al sistema remoto será típicamente
diferente para cada usuario. Aún así, necesitamos indicar en qué sistema
estamos introduciendo comandos, por lo que adoptaremos la siguiente
convención:</p>
<ul>
<li>
<code>[you@laptop:~]$</code> cuando el comando deba introducirse en
un terminal conectado a su ordenador local</li>
<li>
<code>[yourUsername@login1 ~]</code> cuando el comando deba
introducirse en un terminal conectado al sistema remoto</li>
<li>
<code>$</code> cuando realmente no importa a qué sistema está
conectado el terminal.</li>
</ul></section><section><h2 class="section-heading" id="echando-un-vistazo-a-tu-home-remoto">Echando un vistazo a tu home remoto<a class="anchor" aria-label="anchor" href="#echando-un-vistazo-a-tu-home-remoto"></a>
</h2>
<hr class="half-width">
<p>Muy a menudo, muchos usuarios se ven tentados a pensar que una
instalación de computación de alto rendimiento es una máquina gigante y
mágica. A veces, la gente asume que el ordenador en el que han iniciado
sesión es todo el clúster de computación. Pero, ¿qué ocurre realmente?
¿En qué ordenador hemos iniciado sesión? El nombre del ordenador en el
que hemos iniciado sesión se puede comprobar con el comando
<code>hostname</code>. (¡También puedes notar que el nombre de host
actual es también parte de nuestro prompt!)</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] hostname</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">login1</span></span></code></pre>
</div>
<p>Ya estamos en la máquina remota. A continuación, vamos a averiguar
dónde estamos ejecutando <code>pwd</code> para printar el directorio de
trabajo (print working directory).</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] pwd</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/home/yourUsername</code></pre>
</div>
<p>¡Genial, ya sabemos dónde estamos! Veamos qué hay en nuestro
directorio actual:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] ls</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">id_ed25519.pub</span></span></code></pre>
</div>
<p>Es posible que los administradores del sistema hayan configurado tu
directorio de inicio con algunos archivos, carpetas y enlaces (accesos
directos) útiles al espacio reservado para ti en otros sistemas de
archivos. Si no lo han hecho, tu directorio personal puede aparecer
vacío. Para volver a comprobarlo, incluya los archivos ocultos en su
listado de directorios:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] ls <span class="at">-a</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  .            .bashrc           id_ed25519.pub
  ..           .ssh</code></pre>
</div>
<p>En la primera columna, <code>.</code> es una referencia al directorio
actual y <code>..</code> una referencia a su padre (<code>/home</code>).
Puede que veas o no los otros ficheros, o ficheros como ellos:
<code>.bashrc</code> es un fichero de configuración del shell, que
puedes editar con tus preferencias; y <code>.ssh</code> es un directorio
que almacena claves SSH y un registro de conexiones autorizadas.</p>
<div class="section level3">
<h3 id="instale-su-clave-ssh">Instale su clave SSH<a class="anchor" aria-label="anchor" href="#instale-su-clave-ssh"></a>
</h3>
<div id="puede-haber-una-manera-mejor" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="puede-haber-una-manera-mejor" class="callout-inner">
<h3 class="callout-title">Puede haber una manera mejor</h3>
<div class="callout-content">
<p>Las políticas y prácticas para el manejo de claves SSH varían entre
clusters HPC: siga cualquier guía proporcionada por los administradores
del cluster o la documentación. En particular, si existe un portal en
línea para la gestión de claves SSH, utilícelo en lugar de las
instrucciones descritas aquí.</p>
</div>
</div>
</div>
<p>Si transfirió su clave pública SSH con <code>scp</code>, debería ver
<code>id_ed25519.pub</code> en su directorio personal. Para “instalar”
esta clave, debe aparecer en un archivo llamado
<code>authorized_keys</code> en la carpeta <code>.ssh</code>.</p>
<p>Si la carpeta <code>.ssh</code> no aparece en la lista anterior, es
que aún no existe: créala.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] mkdir ~/.ssh</span></code></pre>
</div>
<p>Ahora, utiliza <code>cat</code> para imprimir tu clave pública, pero
redirige la salida, añadiéndola al archivo
<code>authorized_keys</code>:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat ~/id_ed25519.pub <span class="op">&gt;&gt;</span> ~/.ssh/authorized_keys</span></code></pre>
</div>
<p>¡Eso es todo! Desconéctese e intente conectarse de nuevo al remoto:
si su clave y agente han sido configurados correctamente, no se le
pedirá la contraseña de su clave SSH.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] logout</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh yourUsername@cluster.hpc-carpentry.org</span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul>
<li>Un sistema HPC es un conjunto de máquinas conectadas en red.</li>
<li>Los sistemas HPC suelen proporcionar nodos de inicio de sesión y un
conjunto de nodos trabajadores.</li>
<li>Los recursos que se encuentran en los nodos independientes
(trabajadores) pueden variar en volumen y tipo (cantidad de RAM,
arquitectura del procesador, disponibilidad de sistemas de archivos
montados en red, etc.).</li>
<li>Los archivos guardados en un nodo están disponibles en todos los
nodos.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-12-cluster"><p>Content from <a href="12-cluster.html">Trabajar en un sistema HPC remoto</a></p>
<hr>
<p>Última actualización: 2025-08-04 |

        <a href="https://github.com/ocaisa/probable-pancake/edit/main/episodes/12-cluster.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Tiempo estimado: <i aria-hidden="true" data-feather="clock"></i> 35 minutos</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>“¿Qué es un sistema HPC?”</li>
<li>“¿Cómo funciona un sistema HPC?”</li>
<li>“¿Cómo me conecto a un sistema HPC remoto?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<ul>
<li>“Conectarse a un sistema HPC remoto”</li>
<li>“Comprender la arquitectura general del sistema HPC”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="qué-es-un-sistema-hpc">¿Qué es un sistema HPC?<a class="anchor" aria-label="anchor" href="#qu%C3%A9-es-un-sistema-hpc"></a>
</h2>
<hr class="half-width">
<p>Las palabras “nube”, “clúster”, y la frase “computación de alto
rendimiento” o “HPC” se utilizan mucho en diferentes contextos y con
varios significados relacionados. ¿Qué significan? Y lo que es más
importante, ¿cómo los utilizamos en nuestro trabajo?</p>
<p>La <em>nube</em> es un término genérico comúnmente utilizado para
referirse a los recursos informáticos que son a) <em>proporcionados</em>
a los usuarios bajo demanda o según sus necesidades y b) representan
recursos reales o <em>virtuales</em> que pueden estar localizados en
cualquier lugar de la Tierra. Por ejemplo, una gran empresa con recursos
informáticos en Brasil, Zimbabue y Japón puede gestionar esos recursos
como su propia nube <em>interna</em> y esa misma empresa puede utilizar
también recursos comerciales en la nube proporcionados por Amazon o
Google. Los recursos en la nube pueden referirse a máquinas que realizan
tareas relativamente sencillas como servir sitios web, proporcionar
almacenamiento compartido, proporcionar servicios web (como correo
electrónico o plataformas de medios sociales), así como tareas más
tradicionales de computación intensiva como ejecutar una simulación.</p>
<p>El término <em>sistema HPC</em>, por otro lado, describe un recurso
independiente para cargas de trabajo computacionalmente intensivas.
Suelen estar compuestos por una multitud de elementos integrados de
procesamiento y almacenamiento, diseñados para manejar grandes volúmenes
de datos y/o grandes números de operaciones en coma flotante (<a href="https://en.wikipedia.org/wiki/FLOPS" class="external-link">FLOPS</a>) con el mayor
rendimiento posible. Por ejemplo, todas las máquinas de la lista <a href="https://www.top500.org" class="external-link">Top-500</a> son sistemas HPC. Para
soportar estas limitaciones, un recurso HPC debe existir en una
ubicación específica y fija: los cables de red sólo pueden estirarse
hasta cierto punto, y las señales eléctricas y ópticas sólo pueden
viajar a cierta velocidad.</p>
<p>La palabra “clúster” se utiliza a menudo para recursos HPC de escala
pequeña a moderada menos impresionantes que el <a href="https://www.top500.org" class="external-link">Top-500</a>. Los clústeres suelen
mantenerse en centros de cálculo que soportan varios sistemas de este
tipo, todos ellos compartiendo redes y almacenamiento comunes para
soportar tareas comunes de cálculo intensivo.</p>
</section><section><h2 class="section-heading" id="inicio-de-sesión">Inicio de sesión<a class="anchor" aria-label="anchor" href="#inicio-de-sesi%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>El primer paso para utilizar un clúster es establecer una conexión
entre nuestro portátil y el clúster. Cuando estamos sentados frente a un
ordenador (o de pie, o sosteniéndolo en la mano o en la muñeca),
esperamos ver una pantalla con iconos, widgets y quizás algunas ventanas
o aplicaciones: una interfaz gráfica de usuario o GUI. Dado que los
clústeres informáticos son recursos remotos a los que nos conectamos a
través de interfaces a menudo lentas o con retardo (WiFi y VPN,
especialmente), es más práctico utilizar una interfaz de línea de
comandos, o CLI, en la que los comandos y los resultados se transmiten
únicamente a través de texto. Todo lo que no sea texto (imágenes, por
ejemplo) debe escribirse en disco y abrirse con un programa aparte.</p>
<p>Si alguna vez has abierto el símbolo del sistema de Windows o el
terminal de macOS, habrás visto una CLI. Si ya has tomado los cursos de
Las Carpinterías sobre la Shell UNIX o el Control de Versiones, has
usado la CLI en tu máquina local algo extensamente. El único salto a dar
aquí es abrir un CLI en una máquina <em>remota</em>, tomando algunas
precauciones para que otras personas en la red no puedan ver (o cambiar)
los comandos que estás ejecutando o los resultados que la máquina remota
envía de vuelta. Usaremos el protocolo Secure SHell (o SSH) para abrir
una conexión de red encriptada entre dos máquinas, permitiéndote enviar
y recibir texto y datos sin tener que preocuparte de miradas
indiscretas.</p>
<figure><img src="../fig/connect-to-remote.svg" alt-text="Conectarse al clúster" alt="Conectarse al clúster" class="figure mx-auto d-block"><div class="figcaption">Conectarse al clúster</div>
</figure><p>Asegúrese de que tiene un cliente SSH instalado en su portátil.
Consulte la sección <a href="index.html">setup</a> para más detalles.
Los clientes SSH suelen ser herramientas de línea de comandos, donde se
proporciona la dirección de la máquina remota como único argumento
requerido. Si tu nombre de usuario en el sistema remoto difiere del que
usas localmente, debes proporcionarlo también. Si tu cliente SSH tiene
un front-end gráfico, como PuTTY o MobaXterm, establecerás estos
argumentos antes de hacer clic en “conectar” Desde el terminal,
escribirás algo como <code>ssh userName@hostname</code>, donde el
símbolo “@” se utiliza para separar las dos partes de un único
argumento.</p>
<p>Sigue adelante y abre tu terminal o cliente gráfico SSH, luego inicia
sesión en el cluster usando tu nombre de usuario y el ordenador remoto
al que puedes acceder desde el mundo exterior,
cluster.hpc-carpentry.org.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh yourUsername@cluster.hpc-carpentry.org</span></code></pre>
</div>
<p>Recuerda sustituir <code>yourUsername</code> por tu nombre de usuario
o el que te proporcionen los instructores. Es posible que te pidan tu
contraseña. Atención: los caracteres que escriba después de la solicitud
de contraseña no se mostrarán en pantalla. La salida normal se reanudará
cuando pulse <code>Enter</code>.</p>
</section><section><h2 class="section-heading" id="dónde-estamos">¿Dónde estamos?<a class="anchor" aria-label="anchor" href="#d%C3%B3nde-estamos"></a>
</h2>
<hr class="half-width">
<p>Muy a menudo, muchos usuarios se ven tentados a pensar que una
instalación de computación de alto rendimiento es una máquina gigante y
mágica. A veces, la gente asume que el ordenador en el que han iniciado
sesión es todo el clúster de computación. Pero, ¿qué ocurre realmente?
¿En qué ordenador hemos iniciado sesión? El nombre del ordenador en el
que hemos iniciado sesión se puede comprobar con el comando
<code>hostname</code>. (¡También puedes notar que el nombre de host
actual es también parte de nuestro prompt!)</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] hostname</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">login1</span></span></code></pre>
</div>
<div id="qué-hay-en-tu-directorio-de-inicio" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="qué-hay-en-tu-directorio-de-inicio" class="callout-inner">
<h3 class="callout-title">¿Qué hay en tu directorio de inicio?</h3>
<div class="callout-content">
<p>Es posible que los administradores del sistema hayan configurado su
directorio personal con algunos archivos, carpetas y enlaces (accesos
directos) útiles a espacios reservados para usted en otros sistemas de
archivos. Eche un vistazo a ver qué encuentra. <em>Sugerencia:</em> Los
comandos del shell <code>pwd</code> y <code>ls</code> pueden resultarle
útiles. El contenido de los directorios personales varía de un usuario a
otro. Por favor, comenta cualquier diferencia que encuentres con tus
vecinos.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Hace un día precioso en el barrio </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>La capa más profunda debe diferir: <code>yourUsername</code> es
exclusivamente suya. ¿Hay diferencias en la ruta en los niveles
superiores?</p>
<p>Si ambos tienen directorios vacíos, se verán idénticos. Si tú o tu
vecino habéis usado el sistema antes, puede haber diferencias. ¿En qué
estás trabajando?</p>
<p>Utilice <code>pwd</code> para imprimir la ruta del directorio de
trabajo:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] pwd</span></code></pre>
</div>
<p>Puede ejecutar <code>ls</code> para
<strong>l</strong>i<strong>s</strong>tar el contenido del directorio,
aunque es posible que no aparezca nada (si no se han proporcionado
ficheros). Para estar seguro, utilice también el indicador
<code>-a</code> para mostrar los archivos ocultos.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] ls <span class="at">-a</span></span></code></pre>
</div>
<p>Como mínimo, esto mostrará el directorio actual como <code>.</code>,
y el directorio padre como <code>..</code>.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="nodos">Nodos<a class="anchor" aria-label="anchor" href="#nodos"></a>
</h2>
<hr class="half-width">
<p>Los ordenadores individuales que componen un clúster se suelen llamar
<em>nodos</em> (aunque también se les llama <em>servidores</em>,
<em>ordenadores</em> y <em>máquinas</em>). En un clúster, hay distintos
tipos de nodos para distintos tipos de tareas. El nodo en el que te
encuentras en este momento se llama <em>nodo de cabecera</em>, <em>nodo
de inicio de sesión</em>, <em>almohadilla de aterrizaje</em> o <em>nodo
de envío</em>. Un nodo de inicio de sesión sirve como punto de acceso al
clúster.</p>
<p>Como pasarela, es muy adecuada para subir y descargar archivos,
configurar software y realizar pruebas rápidas. En general, el nodo de
acceso no debe utilizarse para tareas que consuman mucho tiempo o
recursos. Deberías estar atento a esto, y comprobar con los operadores o
la documentación de tu sitio los detalles de lo que está y no está
permitido. En estas lecciones, evitaremos ejecutar trabajos en el nodo
principal.</p>
<div id="nodos-de-transferencia-dedicados" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="nodos-de-transferencia-dedicados" class="callout-inner">
<h3 class="callout-title">Nodos de transferencia dedicados</h3>
<div class="callout-content">
<p>Si desea transferir grandes cantidades de datos hacia o desde el
clúster, algunos sistemas ofrecen nodos dedicados sólo para
transferencias de datos. La motivación de esto radica en el hecho de que
las transferencias de datos más grandes no deben obstruir el
funcionamiento del nodo de inicio de sesión para nadie más. Comprueba en
la documentación de tu clúster o con su equipo de soporte si existe un
nodo de transferencia de este tipo. Como regla general, considere todas
las transferencias de un volumen superior a 500 MB a 1 GB como grandes.
Pero estos números cambian, por ejemplo, en función de la conexión de
red propia y de su clúster u otros factores.</p>
</div>
</div>
</div>
<p>El verdadero trabajo en un cluster lo hacen los <em>nodos de
trabajo</em> (o <em>computación</em>). Los nodos de trabajo tienen
muchas formas y tamaños, pero generalmente se dedican a tareas largas o
difíciles que requieren muchos recursos computacionales.</p>
<p>Toda la interacción con los nodos trabajadores es manejada por una
pieza especializada de software llamada planificador (el planificador
utilizado en esta lección se llama <strong>Slurm</strong>). Aprenderemos
más sobre cómo usar el planificador para enviar trabajos a continuación,
pero por ahora, también puede darnos más información sobre los nodos
trabajadores.</p>
<p>Por ejemplo, podemos ver todos los nodos trabajadores ejecutando el
comando <code>sinfo</code>.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sinfo</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>PARTITION          AVAIL  TIMELIMIT  NODES  STATE NODELIST
cpubase_bycore_b1*    up   infinite      4   idle node[1-2],smnode[1-2]
node                  up   infinite      2   idle node[1-2]
smnode                up   infinite      2   idle smnode[1-2]</code></pre>
</div>
<p>También hay máquinas especializadas que se utilizan para gestionar el
almacenamiento en disco, la autenticación de usuarios y otras tareas
relacionadas con la infraestructura. Aunque no solemos iniciar sesión o
interactuar con estas máquinas directamente, permiten una serie de
características clave como asegurar que nuestra cuenta de usuario y
archivos están disponibles en todo el sistema HPC.</p>
</section><section><h2 class="section-heading" id="qué-hay-en-un-nodo">¿Qué hay en un Nodo?<a class="anchor" aria-label="anchor" href="#qu%C3%A9-hay-en-un-nodo"></a>
</h2>
<hr class="half-width">
<p>Todos los nodos de un sistema HPC tienen los mismos componentes que
su propio ordenador portátil o de sobremesa: <em>CPUs</em> (a veces
también llamados <em>procesadores</em> o <em>cores</em>),
<em>memoria</em> (o <em>RAM</em>) y <em>espacio de disco</em>. Las CPU
son la herramienta de un ordenador para ejecutar programas y cálculos.
La información sobre una tarea en curso se almacena en la memoria del
ordenador. Disco se refiere a todo el almacenamiento al que se puede
acceder como un sistema de archivos. Por lo general, se trata de un
almacenamiento que puede guardar datos de forma permanente, es decir,
los datos siguen ahí aunque se reinicie el ordenador. Aunque este
almacenamiento puede ser local (un disco duro instalado en su interior),
es más común que los nodos se conecten a un servidor de archivos
compartido y remoto o a un clúster de servidores.</p>
<figure><img src="../fig/node_anatomy.png" max-width="20%" caption="" alt="Anatomía del nodo" class="figure mx-auto d-block"><div class="figcaption">Anatomía del nodo</div>
</figure><div id="explore-su-ordenador" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="explore-su-ordenador" class="callout-inner">
<h3 class="callout-title">Explore su ordenador</h3>
<div class="callout-content">
<p>Intenta averiguar el número de CPUs y la cantidad de memoria
disponible en tu ordenador personal. Ten en cuenta que, si has iniciado
sesión en el clúster de ordenadores remotos, primero tienes que cerrar
la sesión. Para ello, escriba <code>Ctrl+d</code> o
<code>exit</code>:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] exit</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Mostrar la solución </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Hay varias maneras de hacer esto. La mayoría de los sistemas
operativos tienen un monitor gráfico del sistema, como el Administrador
de tareas de Windows. A veces se puede encontrar información más
detallada en la línea de comandos. Por ejemplo, algunos de los comandos
utilizados en un sistema Linux son:</p>
<p>Ejecutar utilidades del sistema</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> nproc <span class="at">--all</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> free <span class="at">-m</span></span></code></pre>
</div>
<p>Lectura de <code>/proc</code></p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> cat /proc/cpuinfo</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> cat /proc/meminfo</span></code></pre>
</div>
<p>Utilizar un monitor del sistema</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> htop</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="explorar-el-nodo-de-acceso" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="explorar-el-nodo-de-acceso" class="callout-inner">
<h3 class="callout-title">Explorar el nodo de acceso</h3>
<div class="callout-content">
<p>Ahora compara los recursos de tu ordenador con los del nodo
principal.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Mostrar la solución </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh yourUsername@cluster.hpc-carpentry.org</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] nproc <span class="at">--all</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] free <span class="at">-m</span></span></code></pre>
</div>
<p>Puedes obtener más información sobre los procesadores usando
<code>lscpu</code>, y muchos detalles sobre la memoria leyendo el
fichero <code>/proc/meminfo</code>:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] less /proc/meminfo</span></code></pre>
</div>
<p>También puedes explorar los sistemas de ficheros disponibles usando
<code>df</code> para mostrar el espacio <strong>d</strong>isk
<strong>f</strong>ree. La opción <code>-h</code> muestra los tamaños en
un formato amigable, es decir, GB en lugar de B. La opción
<strong>t</strong>ype <code>-T</code> muestra qué tipo de sistema de
ficheros es cada recurso.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] df <span class="at">-Th</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discusión</h3>
<div class="callout-content">
<p>Los sistemas de ficheros locales (ext, tmp, xfs, zfs) dependerán de
si estás en el mismo nodo de login (o nodo de computación, más
adelante). Los sistemas de ficheros en red (beegfs, cifs, gpfs, nfs,
pvfs) serán similares — pero pueden incluir yourUsername, dependiendo de
cómo esté <a href="https://en.wikipedia.org/wiki/Mount_(computing)" class="external-link">montado</a>.</p>
</div>
</div>
</div>
<div id="sistemas-de-archivos-compartidos" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="sistemas-de-archivos-compartidos" class="callout-inner">
<h3 class="callout-title">Sistemas de archivos compartidos</h3>
<div class="callout-content">
<p>Es importante recordar que los archivos guardados en un nodo
(ordenador) suelen estar disponibles en cualquier parte del clúster</p>
</div>
</div>
</div>
<div id="explore-a-worker-node" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="explore-a-worker-node" class="callout-inner">
<h3 class="callout-title">Explore a Worker Node</h3>
<div class="callout-content">
<p>Finally, let’s look at the resources available on the worker nodes
where your jobs will actually run. Try running this command to see the
name, CPUs and memory available on one of the worker nodes:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sinfo <span class="at">-o</span> <span class="st">"%n %c %m"</span> <span class="kw">|</span> <span class="ex">column</span> <span class="at">-t</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="compare-su-ordenador-el-nodo-de-inicio-de-sesión-y-el-nodo-de-cálculo" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="compare-su-ordenador-el-nodo-de-inicio-de-sesión-y-el-nodo-de-cálculo" class="callout-inner">
<h3 class="callout-title">Compare su ordenador, el nodo de inicio de sesión y el nodo de cálculo</h3>
<div class="callout-content">
<p>Compara el número de procesadores y memoria de tu portátil con los
números que ves en el nodo cabeza del cluster y en el nodo trabajador.
Discute las diferencias con tu vecino.</p>
<p>¿Qué implicaciones crees que pueden tener las diferencias a la hora
de ejecutar tu trabajo de investigación en los distintos sistemas y
nodos?</p>
</div>
</div>
</div>
<div id="diferencias-entre-nodos" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="diferencias-entre-nodos" class="callout-inner">
<h3 class="callout-title">Diferencias entre nodos</h3>
<div class="callout-content">
<p>Muchos clusters HPC tienen una variedad de nodos optimizados para
cargas de trabajo particulares. Algunos nodos pueden tener una mayor
cantidad de memoria, o recursos especializados como Unidades de
Procesamiento Gráfico (GPUs).</p>
</div>
</div>
</div>
<p>Con todo esto en mente, ahora veremos cómo hablar con el planificador
del clúster y utilizarlo para empezar a ejecutar nuestros scripts y
programas</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul>
<li>“Un sistema HPC es un conjunto de máquinas conectadas en red”</li>
<li>“Los sistemas HPC suelen proporcionar nodos de inicio de sesión y un
conjunto de nodos trabajadores”</li>
<li>“Los recursos que se encuentran en nodos independientes
(trabajadores) pueden variar en volumen y tipo (cantidad de RAM,
arquitectura del procesador, disponibilidad de sistemas de ficheros
montados en red, etc.).”</li>
<li>“Los archivos guardados en un nodo están disponibles en todos los
nodos”</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-13-scheduler"><p>Content from <a href="13-scheduler.html">Fundamentos del programador</a></p>
<hr>
<p>Última actualización: 2025-08-04 |

        <a href="https://github.com/ocaisa/probable-pancake/edit/main/episodes/13-scheduler.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Tiempo estimado: <i aria-hidden="true" data-feather="clock"></i> 75 minutos</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Qué es un planificador y por qué un clúster necesita uno?</li>
<li>¿Cómo lanzo un programa para que se ejecute en un nodo de cálculo
del clúster?</li>
<li>¿Cómo puedo capturar la salida de un programa que se ejecuta en un
nodo del clúster?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<ul>
<li>Envía un script simple al cluster.</li>
<li>Supervisar la ejecución de los trabajos mediante herramientas de
línea de comandos.</li>
<li>Inspeccione los archivos de salida y error de sus trabajos.</li>
<li>Encontrar el lugar adecuado para colocar grandes conjuntos de datos
en el clúster.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="programador-de-trabajos">Programador de trabajos<a class="anchor" aria-label="anchor" href="#programador-de-trabajos"></a>
</h2>
<hr class="half-width">
<p>Un sistema HPC puede tener miles de nodos y miles de usuarios. ¿Cómo
decidimos quién recibe qué y cuándo? ¿Cómo nos aseguramos de que una
tarea se ejecuta con los recursos que necesita? De esta tarea se encarga
un software especial llamado <em>programador</em>. En un sistema HPC, el
programador gestiona qué tareas se ejecutan, dónde y cuándo.</p>
<p>La siguiente ilustración compara las tareas de un programador de
tareas con las de un camarero en un restaurante. Si puede relacionarlo
con un caso en el que tuvo que esperar un rato en una cola para entrar
en un restaurante popular, entonces ahora puede entender por qué a veces
su trabajo no se inicia instantáneamente como en su ordenador
portátil.</p>
<figure><img src="../fig/restaurant_queue_manager.svg" alt="Compara un programador de tareas con un camarero en un restaurante" max-width="75%" class="figure mx-auto d-block"></figure><p>El planificador utilizado en esta lección es Slurm. Aunque Slurm no
se utiliza en todas partes, la ejecución de trabajos es bastante similar
independientemente del software que se utilice. La sintaxis exacta puede
cambiar, pero los conceptos siguen siendo los mismos.</p>
</section><section><h2 class="section-heading" id="ejecución-de-un-trabajo-por-lotes">Ejecución de un trabajo por lotes<a class="anchor" aria-label="anchor" href="#ejecuci%C3%B3n-de-un-trabajo-por-lotes"></a>
</h2>
<hr class="half-width">
<p>El uso más básico del planificador es ejecutar un comando de forma no
interactiva. Cualquier comando (o serie de comandos) que desee ejecutar
en el cluster se denomina <em>job</em>, y el proceso de utilizar un
planificador para ejecutar el trabajo se denomina <em>sometimiento de
trabajo por lotes</em>.</p>
<p>En este caso, el trabajo que queremos ejecutar es un script de shell
– esencialmente un archivo de texto que contiene una lista de comandos
UNIX para ser ejecutados de manera secuencial. Nuestro script de shell
tendrá tres partes:</p>
<ul>
<li>En la primera línea, añada <code>#!/bin/bash</code>. El
<code>#!</code> (pronunciado “hash-bang” o “shebang”) indica al
ordenador qué programa debe procesar el contenido de este fichero. En
este caso, le estamos diciendo que los comandos que siguen están
escritos para la shell de línea de comandos (en la que hemos estado
haciendo todo hasta ahora).</li>
<li>En cualquier lugar debajo de la primera línea, añadiremos un comando
<code>echo</code> con un saludo amistoso. Cuando se ejecute, el script
de shell imprimirá lo que venga después de <code>echo</code> en el
terminal.
<ul>
<li>
<code>echo -n</code> imprimirá todo lo que sigue, <em>sin</em>
terminar la línea imprimiendo el carácter de nueva línea.</li>
</ul>
</li>
<li>En la última línea, invocaremos el comando <code>hostname</code>,
que imprimirá el nombre de la máquina en la que se ejecuta el
script.</li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] nano example-job.sh</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">"This script is running on "</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">hostname</span></span></code></pre>
</div>
<div id="creación-de-nuestro-trabajo-de-prueba" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="creación-de-nuestro-trabajo-de-prueba" class="callout-inner">
<h3 class="callout-title">Creación de nuestro trabajo de prueba</h3>
<div class="callout-content">
<p>Ejecuta el script. ¿Se ejecuta en el clúster o sólo en nuestro nodo
de inicio de sesión?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Solución
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] bash example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This script is running on login1</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Este script se ejecutó en el nodo de inicio de sesión, pero queremos
aprovechar los nodos de computación: necesitamos que el planificador
ponga en cola <code>example-job.sh</code> para ejecutarse en un nodo de
computación.</p>
<p>Para enviar esta tarea al planificador, usamos el comando
<code>sbatch</code>. Esto crea un <em>job</em> que ejecutará el
<em>script</em> cuando sea <em>despachado</em> a un nodo de computación
que el sistema de colas haya identificado como disponible para realizar
el trabajo.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch  example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Submitted batch job 7</code></pre>
</div>
<p>Y eso es todo lo que tenemos que hacer para enviar un trabajo.
Nuestro trabajo está hecho – ahora el programador toma el relevo e
intenta ejecutar el trabajo por nosotros. Mientras el trabajo espera a
ejecutarse, entra en una lista de trabajos llamada <em>cola</em>. Para
comprobar el estado de nuestro trabajo, comprobamos la cola utilizando
el comando <code>squeue -u yourUsername</code>.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] squeue <span class="at">-u</span> yourUsername</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
    9 cpubase_b example-   user01  R       0:05      1 node1</code></pre>
</div>
<p>Podemos ver todos los detalles de nuestro trabajo, lo más importante
es que está en el estado <code>R</code> o <code>RUNNING</code>. A veces
nuestros trabajos pueden necesitar esperar en una cola
(<code>PENDING</code>) o tener un error (<code>E</code>).</p>
<div id="dónde-está-la-salida" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="dónde-está-la-salida" class="callout-inner">
<h3 class="callout-title">¿Dónde está la salida?</h3>
<div class="callout-content">
<p>En el nodo de inicio de sesión, este script imprimió la salida en el
terminal – pero ahora, cuando <code>squeue</code> muestra que el trabajo
ha finalizado, no se imprimió nada en el terminal.</p>
<p>La salida del trabajo de cluster se redirige normalmente a un archivo
en el directorio desde el que se lanzó. Utilice <code>ls</code> para
buscar y <code>cat</code> para leer el archivo.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="personalización-de-un-trabajo">Personalización de un trabajo<a class="anchor" aria-label="anchor" href="#personalizaci%C3%B3n-de-un-trabajo"></a>
</h2>
<hr class="half-width">
<p>El trabajo que acabamos de ejecutar utilizaba todas las opciones por
defecto del planificador. En un escenario del mundo real, eso no es
probablemente lo que queremos. Las opciones por defecto representan un
mínimo razonable. Lo más probable es que necesitemos más núcleos, más
memoria, más tiempo, entre otras consideraciones especiales. Para tener
acceso a estos recursos debemos personalizar nuestro script de
trabajo.</p>
<p>Los comentarios en los scripts de shell UNIX (denotados por
<code>#</code>) son normalmente ignorados, pero hay excepciones. Por
ejemplo, el comentario especial <code>#!</code> al principio de los
scripts especifica qué programa debe usarse para ejecutarlo (normalmente
verá <code>#!/usr/bin/env bash</code>). Los programadores como Slurm
también tienen un comentario especial que se utiliza para indicar
opciones específicas del programador. Aunque estos comentarios difieren
de un programador a otro, el comentario especial de Slurm es
<code>#SBATCH</code>. Todo lo que sigue al comentario
<code>#SBATCH</code> se interpreta como una instrucción para el
programador.</p>
<p>Vamos a ilustrarlo con un ejemplo. Por defecto, el nombre de un
trabajo es el nombre del script, pero se puede utilizar la opción
<code>-J</code> para cambiar el nombre de un trabajo. Añade una opción
al script:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat example-job.sh</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#SBATCH -J hello-world</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">"This script is running on "</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">hostname</span></span></code></pre>
</div>
<p>Envía el trabajo y supervisa su estado:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch  example-job.sh</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] squeue <span class="at">-u</span> yourUsername</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
   10 cpubase_b hello-wo   user01  R       0:02      1 node1</code></pre>
</div>
<p>¡Fantástico, hemos cambiado con éxito el nombre de nuestro
trabajo!</p>
<div class="section level3">
<h3 id="solicitudes-de-recursos">Solicitudes de recursos<a class="anchor" aria-label="anchor" href="#solicitudes-de-recursos"></a>
</h3>
<p>¿Qué pasa con los cambios más importantes, como el número de núcleos
y memoria para nuestros trabajos? Una cosa que es absolutamente crítica
cuando se trabaja en un sistema HPC es especificar los recursos
necesarios para ejecutar un trabajo. Esto permite al programador
encontrar el momento y el lugar adecuados para programar nuestro
trabajo. Si no especifica los requisitos (como la cantidad de tiempo que
necesita), es probable que se quede con los recursos predeterminados de
su sitio, que probablemente no es lo que desea.</p>
<p>A continuación se muestran varias solicitudes de recursos clave:</p>
<ul>
<li><p><code>--ntasks=&lt;ntasks&gt;</code> o
<code>-n &lt;ntasks&gt;</code>: ¿Cuántos núcleos de CPU necesita su
trabajo, en total?</p></li>
<li><p><code>--time &lt;days-hours:minutes:seconds&gt;</code> o
<code>-t &lt;days-hours:minutes:seconds&gt;</code>: ¿Cuánto tiempo real
(walltime) tardará en ejecutarse tu tarea? La parte
<code>&lt;days&gt;</code> puede omitirse.</p></li>
<li><p><code>--mem=&lt;megabytes&gt;</code>: ¿Cuánta memoria en un nodo
necesita su trabajo en megabytes? También puede especificar gigabytes
añadiendo una pequeña “g” después (ejemplo:
<code>--mem=5g</code>)</p></li>
<li><p><code>--nodes=&lt;nnodes&gt;</code> o
<code>-N &lt;nnodes&gt;</code>: ¿En cuántas máquinas distintas debe
ejecutarse su trabajo? Tenga en cuenta que si establece
<code>ntasks</code> en un número superior al que puede ofrecer una
máquina, Slurm establecerá este valor automáticamente.</p></li>
</ul>
<p>Tenga en cuenta que el simple hecho de <em>solicitar</em> estos
recursos no hace que su trabajo se ejecute más rápido, ni significa
necesariamente que vaya a consumir todos estos recursos. Sólo significa
que se ponen a su disposición. Tu trabajo puede terminar usando menos
memoria, o menos tiempo, o menos nodos de los que has solicitado, y aún
así se ejecutará.</p>
<p>Lo mejor es que tus solicitudes reflejen fielmente los requisitos de
tu trabajo. Hablaremos más acerca de cómo asegurarse de que está
utilizando los recursos de manera efectiva en un episodio posterior de
esta lección.</p>
<div id="envío-de-solicitudes-de-recursos" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="envío-de-solicitudes-de-recursos" class="callout-inner">
<h3 class="callout-title">Envío de solicitudes de recursos</h3>
<div class="callout-content">
<p>Modifique nuestro script <code>hostname</code> para que se ejecute
durante un minuto y, a continuación, envíe un trabajo para él en el
clúster.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Solución
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat example-job.sh</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#SBATCH -t 00:01 # timeout in HH:MM</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">"This script is running on "</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">sleep</span> 20 <span class="co"># time in seconds</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="fu">hostname</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch  example-job.sh</span></code></pre>
</div>
<p>¿Por qué el tiempo de ejecución Slurm y el tiempo <code>sleep</code>
no son idénticos?</p>
</div>
</div>
</div>
</div>
<p>Las solicitudes de recursos suelen ser vinculantes. Si las excedes,
tu trabajo será eliminado. Usemos el tiempo de muro como ejemplo.
Solicitaremos 1 minuto de tiempo de muro, e intentaremos ejecutar un
trabajo durante dos minutos.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat example-job.sh</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co">#SBATCH -J long_job</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#SBATCH -t 00:01 # timeout in HH:MM</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"This script is running on ... "</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">sleep</span> 240 <span class="co"># time in seconds</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="fu">hostname</span></span></code></pre>
</div>
<p>Envía el trabajo y espera a que termine. Una vez que haya terminado,
compruebe el archivo de registro.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch  example-job.sh</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] squeue <span class="at">-u</span> yourUsername</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat slurm-12.out</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This script is running on ...
slurmstepd: error: *** JOB 12 ON node1 CANCELLED AT 2021-02-19T13:55:57
DUE TO TIME LIMIT ***</code></pre>
</div>
<p>Nuestro trabajo ha sido cancelado por exceder la cantidad de recursos
solicitados. Aunque esto parece duro, en realidad es una característica.
El cumplimiento estricto de las solicitudes de recursos permite al
planificador encontrar el mejor lugar posible para sus trabajos. Aún más
importante, asegura que otro usuario no pueda usar más recursos de los
que se le han dado. Si otro usuario mete la pata y accidentalmente
intenta utilizar todos los núcleos o la memoria de un nodo, Slurm
restringirá su trabajo a los recursos solicitados o matará el trabajo
directamente. Otros trabajos en el nodo no se verán afectados. Esto
significa que un usuario no puede estropear la experiencia de los demás,
los únicos trabajos afectados por un error en la programación serán los
suyos propios.</p>
</div>
</section><section><h2 class="section-heading" id="cancelación-de-un-trabajo">Cancelación de un trabajo<a class="anchor" aria-label="anchor" href="#cancelaci%C3%B3n-de-un-trabajo"></a>
</h2>
<hr class="half-width">
<p>A veces cometeremos un error y necesitaremos cancelar un trabajo.
Esto se puede hacer con el comando <code>scancel</code>. Vamos a enviar
un trabajo y luego cancelarlo usando su número de trabajo (¡recuerda
cambiar el tiempo de ejecución para que se ejecute el tiempo suficiente
para que puedas cancelarlo antes de que se mate!)</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch  example-job.sh</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] squeue <span class="at">-u</span> yourUsername</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Submitted batch job 13

JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
   13 cpubase_b long_job   user01  R       0:02      1 node1</code></pre>
</div>
<p>Ahora cancele el trabajo con su número de trabajo (impreso en su
terminal). Un retorno limpio de su símbolo del sistema indica que la
solicitud de cancelación del trabajo se ha realizado correctamente.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] scancel 38759</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co"># It might take a minute for the job to disappear from the queue...</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] squeue <span class="at">-u</span> yourUsername</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)</code></pre>
</div>
<div id="cancelación-de-múltiples-trabajos" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="cancelación-de-múltiples-trabajos" class="callout-inner">
<h3 class="callout-title">Cancelación de múltiples trabajos</h3>
<div class="callout-content">
<p>También podemos cancelar todos nuestros trabajos a la vez utilizando
la opción <code>-u</code>. Esto borrará todos los trabajos de un usuario
específico (en este caso, usted mismo). Tenga en cuenta que sólo puede
eliminar sus propios trabajos.</p>
<p>Pruebe a enviar varios trabajos y luego cancélelos todos.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Solución
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>En primer lugar, envíe un trío de trabajos:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch  example-job.sh</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch  example-job.sh</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch  example-job.sh</span></code></pre>
</div>
<p>A continuación, cancélelos todos:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] scancel <span class="at">-u</span> yourUsername</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="otros-tipos-de-trabajos">Otros tipos de trabajos<a class="anchor" aria-label="anchor" href="#otros-tipos-de-trabajos"></a>
</h2>
<hr class="half-width">
<p>Hasta ahora, nos hemos centrado en la ejecución de tareas por lotes.
<code>Slurm</code> también ofrece la posibilidad de iniciar una sesión
interactiva.</p>
<p>Con mucha frecuencia hay tareas que deben realizarse de forma
interactiva. Crear un script de trabajo completo puede ser excesivo,
pero la cantidad de recursos requeridos es demasiado para que un nodo de
inicio de sesión pueda manejarlo. Un buen ejemplo de esto podría ser la
construcción de un índice del genoma para la alineación con una
herramienta como <a href="https://daehwankimlab.github.io/hisat2/" class="external-link">HISAT2</a>.
Afortunadamente, podemos ejecutar este tipo de tareas de una sola vez
con <code>srun</code>.</p>
<p><code>srun</code> ejecuta un único comando en el cluster y luego se
cierra. Demostremos esto ejecutando el comando <code>hostname</code> con
<code>srun</code>. (Podemos cancelar un trabajo <code>srun</code> con
<code>Ctrl-c</code>)</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] srun hostname</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">smnode1</span></span></code></pre>
</div>
<p><code>srun</code> acepta las mismas opciones que <code>sbatch</code>.
Sin embargo, en lugar de especificarlas en un script, estas opciones se
especifican en la línea de comandos al iniciar un trabajo. Para enviar
un trabajo que utilice 2 CPUs, por ejemplo, podríamos utilizar el
siguiente comando:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] srun <span class="at">-n</span> 2 echo <span class="st">"This job will use 2 CPUs."</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This job will use 2 CPUs.
This job will use 2 CPUs.</code></pre>
</div>
<p>Normalmente, el entorno de shell resultante será el mismo que el de
<code>sbatch</code>.</p>
<div class="section level3">
<h3 id="trabajos-interactivos">Trabajos interactivos<a class="anchor" aria-label="anchor" href="#trabajos-interactivos"></a>
</h3>
<p>A veces, necesitaremos muchos recursos para un uso interactivo.
Quizás es la primera vez que ejecutamos un análisis o estamos intentando
depurar algo que salió mal en un trabajo anterior. Afortunadamente,
Slurm facilita el inicio de un trabajo interactivo con
<code>srun</code>:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] srun <span class="at">--pty</span> bash</span></code></pre>
</div>
<p>Aparecerá un prompt bash. Tenga en cuenta que el prompt probablemente
cambiará para reflejar su nueva ubicación, en este caso el nodo de
computación en el que estamos conectados. También puedes verificarlo con
<code>hostname</code>.</p>
<div id="creación-de-gráficos-remotos" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="creación-de-gráficos-remotos" class="callout-inner">
<h3 class="callout-title">Creación de gráficos remotos</h3>
<div class="callout-content">
<p>Para ver la salida gráfica dentro de tus trabajos, necesitas usar X11
forwarding. Para conectarse con esta característica activada, utilice la
opción <code>-Y</code> cuando se conecte con el comando
<code>ssh</code>, por ejemplo,
<code>ssh -Y yourUsername@cluster.hpc-carpentry.org</code>.</p>
<p>Para demostrar lo que ocurre cuando creas una ventana gráfica en el
nodo remoto, utiliza el comando <code>xeyes</code>. Debería aparecer un
par de ojos relativamente adorables (pulse <code>Ctrl-C</code> para
parar). Si utiliza un Mac, debe haber instalado XQuartz (y reiniciado su
ordenador) para que esto funcione.</p>
<p>Si su cluster tiene instalado el plugin <a href="https://github.com/hautreux/slurm-spank-x11" class="external-link">slurm-spank-x11</a>,
puede asegurar el reenvío X11 dentro de los trabajos interactivos
utilizando la opción <code>--x11</code> para <code>srun</code> con el
comando <code>srun --x11 --pty bash</code>.</p>
</div>
</div>
</div>
<p>Cuando haya terminado con el trabajo interactivo, escriba
<code>exit</code> para salir de la sesión.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul>
<li>El planificador gestiona cómo se comparten los recursos informáticos
entre los usuarios.</li>
<li>Un trabajo no es más que un script de shell.</li>
<li>Solicita <em>ligeramente</em> más recursos de los que
necesitará.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-14-environment-variables"><p>Content from <a href="14-environment-variables.html">Variables de entorno</a></p>
<hr>
<p>Última actualización: 2025-08-04 |

        <a href="https://github.com/ocaisa/probable-pancake/edit/main/episodes/14-environment-variables.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Tiempo estimado: <i aria-hidden="true" data-feather="clock"></i> 15 minutos</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo se establecen y acceden a las variables en el intérprete de
comandos Unix?</li>
<li>¿Cómo puedo utilizar variables para cambiar la forma en que se
ejecuta un programa?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<ul>
<li>Comprender cómo se implementan las variables en el shell</li>
<li>Leer el valor de una variable existente</li>
<li>Crear nuevas variables y cambiar sus valores</li>
<li>Cambiar el comportamiento de un programa mediante una variable de
entorno</li>
<li>Explica cómo el shell utiliza la variable <code>PATH</code> para
buscar ejecutables</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="procedencia-del-episodio" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="procedencia-del-episodio" class="callout-inner">
<h3 class="callout-title">Procedencia del episodio</h3>
<div class="callout-content">
<p>Este episodio ha sido remezclado del episodio <a href="https://github.com/carpentries-incubator/shell-extras/blob/gh-pages/_episodes/08-environment-variables.md" class="external-link">Shell
Extras sobre Variables del Shell</a> y del episodio <a href="https://github.com/hpc-carpentry/hpc-shell/blob/gh-pages/_episodes/05-scripts.md" class="external-link">HPC
Shell sobre scripts</a>.</p>
</div>
</div>
</div>
<p>El shell es sólo un programa, y como otros programas, tiene
variables. Esas variables controlan su ejecución, de modo que cambiando
sus valores puedes cambiar cómo se comporta el shell (y con un poco más
de esfuerzo cómo se comportan otros programas).</p>
<p>Las variables son una buena forma de guardar información bajo un
nombre al que puedas acceder más tarde. En lenguajes de programación
como Python y R, las variables pueden almacenar prácticamente cualquier
cosa que se te ocurra. En el shell, normalmente sólo almacenan texto. La
mejor manera de entender cómo funcionan es verlas en acción.</p>
<p>Empecemos ejecutando el comando <code>set</code> y observando algunas
de las variables en una sesión típica de shell:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="bu">set</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>COMPUTERNAME=TURING
HOME=/home/vlad
HOSTNAME=TURING
HOSTTYPE=i686
NUMBER_OF_PROCESSORS=4
PATH=/Users/vlad/bin:/usr/local/git/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin
PWD=/home/vlad
UID=1000
USERNAME=vlad
...</code></pre>
</div>
<p>Como puedes ver, hay bastantes - de hecho, cuatro o cinco veces más
de las que se muestran aquí. Y sí, usar <code>set</code> para
<em>mostrar</em> cosas puede parecer un poco extraño, incluso para Unix,
pero si no le das ningún argumento, bien podría mostrarte cosas que
<em>podrías</em> configurar.</p>
<p>Cada variable tiene un nombre. Todos los valores de las variables del
shell son cadenas, incluso aquellas (como <code>UID</code>) que parecen
números. Depende de los programas convertir estas cadenas a otros tipos
cuando sea necesario. Por ejemplo, si un programa quisiera averiguar
cuántos procesadores tiene el ordenador, convertiría el valor de la
variable <code>NUMBER_OF_PROCESSORS</code> de una cadena a un número
entero.</p>
<section><h2 class="section-heading" id="mostrar-el-valor-de-una-variable">Mostrar el valor de una variable<a class="anchor" aria-label="anchor" href="#mostrar-el-valor-de-una-variable"></a>
</h2>
<hr class="half-width">
<p>Mostremos el valor de la variable <code>HOME</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="bu">echo</span> HOME</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">HOME</span></span></code></pre>
</div>
<p>Esto sólo imprime “HOME”, que no es lo que queríamos (aunque es lo
que pedimos). Intentemos esto en su lugar:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$HOME</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/home/vlad</code></pre>
</div>
<p>El signo de dólar indica al shell que queremos el <em>valor</em> de
la variable en lugar de su nombre. Esto funciona igual que los
comodines: el shell realiza la sustitución <em>antes</em> de ejecutar el
programa que le hemos pedido. Gracias a esta expansión, lo que realmente
ejecutamos es <code>echo /home/vlad</code>, que muestra lo correcto.</p>
</section><section><h2 class="section-heading" id="creación-y-modificación-de-variables">Creación y modificación de variables<a class="anchor" aria-label="anchor" href="#creaci%C3%B3n-y-modificaci%C3%B3n-de-variables"></a>
</h2>
<hr class="half-width">
<p>Crear una variable es fácil - simplemente asignamos un valor a un
nombre usando “=” (¡sólo tenemos que recordar que la sintaxis requiere
que <em>no</em> haya espacios alrededor de <code>=</code>!)</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="va">SECRET_IDENTITY</span><span class="op">=</span>Dracula</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$SECRET_IDENTITY</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Dracula</span></span></code></pre>
</div>
<p>Para cambiar el valor, basta con asignar uno nuevo:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="va">SECRET_IDENTITY</span><span class="op">=</span>Camilla</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$SECRET_IDENTITY</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Camilla</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="variables-de-entorno">Variables de entorno<a class="anchor" aria-label="anchor" href="#variables-de-entorno"></a>
</h2>
<hr class="half-width">
<p>Cuando ejecutamos el comando <code>set</code> vimos que había muchas
variables cuyos nombres estaban en mayúsculas. Esto es porque, por
convención, las variables que también están disponibles para ser usadas
por <em>otros</em> programas reciben nombres en mayúsculas. Tales
variables se llaman <em>variables de entorno</em> ya que son variables
del shell que se definen para el shell actual y son heredadas por
cualquier shell o proceso hijo.</p>
<p>Para crear una variable de entorno necesitas <code>export</code> una
variable del shell. Por ejemplo, para hacer que nuestra
<code>SECRET_IDENTITY</code> esté disponible para otros programas que
llamemos desde nuestra shell podemos hacer:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="va">SECRET_IDENTITY</span><span class="op">=</span>Camilla</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="bu">export</span> <span class="va">SECRET_IDENTITY</span></span></code></pre>
</div>
<p>También puede crear y exportar la variable en un solo paso:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="bu">export</span> <span class="va">SECRET_IDENTITY</span><span class="op">=</span>Camilla</span></code></pre>
</div>
<div id="uso-de-variables-de-entorno-para-cambiar-el-comportamiento-del-programa" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="uso-de-variables-de-entorno-para-cambiar-el-comportamiento-del-programa" class="callout-inner">
<h3 class="callout-title">Uso de variables de entorno para cambiar el comportamiento del programa</h3>
<div class="callout-content">
<p>Establece una variable de shell <code>TIME_STYLE</code> para que
tenga un valor de <code>iso</code> y comprueba este valor usando el
comando <code>echo</code>.</p>
<p>Ahora, ejecuta el comando <code>ls</code> con la opción
<code>-l</code> (que da un formato largo).</p>
<p><code>export</code> la variable y vuelve a ejecutar el comando
<code>ls -l</code>. ¿Notas alguna diferencia?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Solución
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>La variable <code>TIME_STYLE</code> no es <em>vista</em> por
<code>ls</code> hasta que es exportada, momento en el cual es utilizada
por <code>ls</code> para decidir qué formato de fecha utilizar al
presentar la marca de tiempo de los ficheros.</p>
</div>
</div>
</div>
</div>
<p>Puedes ver el conjunto completo de variables de entorno en tu sesión
de shell actual con el comando <code>env</code> (que devuelve un
subconjunto de lo que nos dio el comando <code>set</code>). <strong>El
conjunto completo de variables de entorno se denomina <em>entorno de
ejecución</em> y puede afectar al comportamiento de los programas que
ejecutas</strong>.</p>
<div id="variables-de-entorno-de-trabajo" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="variables-de-entorno-de-trabajo" class="callout-inner">
<h3 class="callout-title">Variables de entorno de trabajo</h3>
<div class="callout-content">
<p>Cuando <code>Slurm</code> ejecuta un trabajo, establece una serie de
variables de entorno para el trabajo. Una de ellas nos permitirá
comprobar desde qué directorio se envió nuestro script de trabajo. La
variable <code>SLURM_SUBMIT_DIR</code> se establece en el directorio
desde el que se envió nuestro trabajo. Usando la variable
<code>SLURM_SUBMIT_DIR</code>, modifica tu tarea para que imprima la
ubicación desde la que se envió la tarea.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Solución
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] nano example-job.sh</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>#!/bin/bash
#SBATCH -t 00:00:30

echo -n "This script is running on "
hostname

echo "This job was launched in the following directory:"
echo ${SLURM_SUBMIT_DIR}</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Para eliminar una variable o variable de entorno puede utilizar el
comando <code>unset</code>, por ejemplo:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="bu">unset</span> <span class="va">SECRET_IDENTITY</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="variable-de-entorno-path">Variable de entorno <code>PATH</code>
<a class="anchor" aria-label="anchor" href="#variable-de-entorno-path"></a>
</h2>
<hr class="half-width">
<p>Del mismo modo, algunas variables de entorno (como <code>PATH</code>)
almacenan listas de valores. En este caso, la convención es utilizar dos
puntos ‘:’ como separador. Si un programa quiere los elementos
individuales de una lista de este tipo, es responsabilidad del programa
dividir el valor de la cadena de la variable en trozos.</p>
<p>Echemos un vistazo más de cerca a la variable <code>PATH</code>. Su
valor define la ruta de búsqueda de ejecutables del intérprete de
comandos, es decir, la lista de directorios en los que el intérprete de
comandos busca programas ejecutables cuando se escribe el nombre de un
programa sin especificar en qué directorio se encuentra.</p>
<p>Por ejemplo, cuando escribimos un comando como <code>analyze</code>,
el intérprete de órdenes tiene que decidir si ejecuta
<code>./analyze</code> o <code>/bin/analyze</code>. La regla que utiliza
es simple: el intérprete de comandos comprueba cada directorio de la
variable <code>PATH</code> por turnos, buscando un programa con el
nombre solicitado en ese directorio. En cuanto encuentra una
coincidencia, deja de buscar y ejecuta el programa.</p>
<p>Para mostrar cómo funciona, aquí están los componentes de
<code>PATH</code> listados uno por línea:</p>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/Users/vlad/bin
/usr/local/git/bin
/usr/bin
/bin
/usr/sbin
/sbin
/usr/local/bin</code></pre>
</div>
<p>En nuestro ordenador, en realidad hay tres programas llamados
<code>analyze</code> en tres directorios diferentes:
<code>/bin/analyze</code>, <code>/usr/local/bin/analyze</code>, y
<code>/users/vlad/analyze</code>. Como el shell busca en los directorios
en el orden en que están listados en <code>PATH</code>, encuentra
<code>/bin/analyze</code> primero y lo ejecuta. Observa que
<em>nunca</em> encontrará el programa <code>/users/vlad/analyze</code> a
menos que introduzcamos la ruta completa al programa, ya que el
directorio <code>/users/vlad</code> no está en <code>PATH</code>.</p>
<p>Esto significa que puedo tener ejecutables en un montón de lugares
diferentes, siempre y cuando recuerde que tengo que actualizar mi
<code>PATH</code> para que mi shell pueda encontrarlos.</p>
<p>¿Qué pasa si quiero ejecutar dos versiones diferentes del mismo
programa? Como comparten el mismo nombre, si añado ambos a mi
<code>PATH</code> el primero que encuentre siempre ganará. En el próximo
episodio aprenderemos a utilizar herramientas de ayuda para gestionar
nuestro entorno de ejecución y hacer que esto sea posible sin tener que
hacer un montón de contabilidad sobre cuál es o debería ser el valor de
<code>PATH</code> (y otras variables de entorno importantes).</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul>
<li>Las variables del intérprete de órdenes se tratan por defecto como
cadenas de caracteres</li>
<li>Las variables se asignan utilizando “<code>=</code>” y se recuperan
utilizando el nombre de la variable precedido por “<code>$</code>”</li>
<li>Utilice “<code>export</code>” para poner una variable a disposición
de otros programas</li>
<li>La variable <code>PATH</code> define la ruta de búsqueda de la
shell</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-15-modules"><p>Content from <a href="15-modules.html">Acceso al software a través de módulos</a></p>
<hr>
<p>Última actualización: 2025-08-04 |

        <a href="https://github.com/ocaisa/probable-pancake/edit/main/episodes/15-modules.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Tiempo estimado: <i aria-hidden="true" data-feather="clock"></i> 45 minutos</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo se cargan y descargan los paquetes de software?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<ul>
<li>Carga y utiliza un paquete de software.</li>
<li>Explique cómo cambia el entorno del intérprete de órdenes cuando el
mecanismo de módulos carga o descarga paquetes.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>En un sistema informático de alto rendimiento, rara vez ocurre que el
software que queremos utilizar esté disponible cuando nos conectamos.
Está instalado, pero tendremos que “cargarlo” antes de que pueda
ejecutarse.</p>
<p>Sin embargo, antes de empezar a utilizar paquetes de software
individuales, deberíamos entender el razonamiento que hay detrás de este
enfoque. Los tres factores más importantes son:</p>
<ul>
<li>incompatibilidades de software</li>
<li>versionado</li>
<li>dependencias</li>
</ul>
<p>La incompatibilidad de software es un gran dolor de cabeza para los
programadores. A veces la presencia (o ausencia) de un paquete de
software rompe otros que dependen de él. Dos ejemplos bien conocidos son
las versiones de Python y del compilador de C. Python 3 proporciona un
comando <code>python</code> que entra en conflicto con el que
proporciona Python 2. El software compilado con una versión más reciente
de las librerías C y ejecutado en una máquina que tiene instaladas
librerías C más antiguas producirá un desagradable error
<code>'GLIBCXX_3.4.20' not found</code>.</p>
<p>El versionado de software es otro problema común. Un equipo puede
depender de una determinada versión de un paquete para su proyecto de
investigación - si la versión del software cambiara (por ejemplo, si se
actualizara un paquete), podría afectar a sus resultados. Tener acceso a
varias versiones de software permite a un conjunto de investigadores
evitar que los problemas de versiones de software afecten a sus
resultados.</p>
<p>Las dependencias se dan cuando un paquete de software concreto (o
incluso una versión concreta) depende de tener acceso a otro paquete de
software (o incluso a una versión concreta de otro paquete de software).
Por ejemplo, el software de ciencia de materiales VASP puede depender de
tener disponible una versión concreta de la biblioteca de software FFTW
(Fastest Fourier Transform in the West) para funcionar.</p>
<section><h2 class="section-heading" id="módulos-de-entorno">Módulos de entorno<a class="anchor" aria-label="anchor" href="#m%C3%B3dulos-de-entorno"></a>
</h2>
<hr class="half-width">
<p>Los módulos de entorno son la solución a estos problemas. Un
<em>módulo</em> es una descripción autocontenida de un paquete de
software – contiene las configuraciones necesarias para ejecutar un
paquete de software y, normalmente, codifica las dependencias necesarias
de otros paquetes de software.</p>
<p>Hay un número de implementaciones de módulos de entorno diferentes
comúnmente usadas en sistemas HPC: los dos más comunes son <em>TCL
modules</em> y <em>Lmod</em>. Ambos usan una sintaxis similar y los
conceptos son los mismos, por lo que aprender a usar uno te permitirá
usar el que esté instalado en el sistema que estés usando. En ambas
implementaciones se utiliza el comando <code>module</code> para
interactuar con los módulos de entorno. Normalmente se añade un
subcomando adicional al comando para especificar lo que se quiere hacer.
Para obtener una lista de subcomandos puede utilizar
<code>module -h</code> o <code>module help</code>. Como para todos los
comandos, puede acceder a la ayuda completa en las páginas <em>man</em>
con <code>man module</code>.</p>
<p>Al iniciar la sesión puede que empiece con un conjunto de módulos
cargados por defecto o puede que empiece con un entorno vacío; esto
depende de la configuración del sistema que esté utilizando.</p>
<div class="section level3">
<h3 id="listado-de-módulos-disponibles">Listado de módulos disponibles<a class="anchor" aria-label="anchor" href="#listado-de-m%C3%B3dulos-disponibles"></a>
</h3>
<p>Para ver los módulos de software disponibles, utilice
<code>module avail</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] module avail</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>~~~ /cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/modules/all ~~~
  Bazel/3.6.0-GCCcore-x.y.z              NSS/3.51-GCCcore-x.y.z
  Bison/3.5.3-GCCcore-x.y.z              Ninja/1.10.0-GCCcore-x.y.z
  Boost/1.72.0-gompi-2020a               OSU-Micro-Benchmarks/5.6.3-gompi-2020a
  CGAL/4.14.3-gompi-2020a-Python-3.x.y   OpenBLAS/0.3.9-GCC-x.y.z
  CMake/3.16.4-GCCcore-x.y.z             OpenFOAM/v2006-foss-2020a

[removed most of the output here for clarity]

  Where:
   L:        Module is loaded
   Aliases:  Aliases exist: foo/1.2.3 (1.2) means that "module load foo/1.2"
             will load foo/1.2.3
   D:        Default Module

Use "module spider" to find all possible modules and extensions.
Use "module keyword key1 key2 ..." to search for all possible modules matching
any of the "keys".</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="listado-de-módulos-cargados-actualmente">Listado de módulos cargados actualmente<a class="anchor" aria-label="anchor" href="#listado-de-m%C3%B3dulos-cargados-actualmente"></a>
</h3>
<p>Puede utilizar el comando <code>module list</code> para ver qué
módulos tiene cargados actualmente en su entorno. Si no tiene ningún
módulo cargado, verá un mensaje indicándoselo</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] module list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>No Modulefiles Currently Loaded.</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="carga-y-descarga-de-software">Carga y descarga de software<a class="anchor" aria-label="anchor" href="#carga-y-descarga-de-software"></a>
</h2>
<hr class="half-width">
<p>Para cargar un módulo de software, utilice <code>module load</code>.
En este ejemplo utilizaremos Python 3.</p>
<p>Inicialmente, Python 3 no está cargado. Podemos comprobarlo usando el
comando <code>which</code>. <code>which</code> busca programas de la
misma forma que lo hace Bash, así que podemos usarlo para que nos diga
dónde está almacenado un software en particular.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] which python3</span></code></pre>
</div>
<p>Si el comando <code>python3</code> no estuviera disponible, veríamos
una salida como</p>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/usr/bin/which: no python3 in (/cvmfs/pilot.eessi-hpc.org/2020.12/compat/linux/x86_64/usr/bin:/opt/software/slurm/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/puppetlabs/bin:/home/yourUsername/.local/bin:/home/yourUsername/bin)</code></pre>
</div>
<p>Observe que este muro de texto es en realidad una lista, con valores
separados por el carácter <code>:</code>. La salida nos está diciendo
que el comando <code>which</code> buscó <code>python3</code> en los
siguientes directorios, sin éxito:</p>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/cvmfs/pilot.eessi-hpc.org/2020.12/compat/linux/x86_64/usr/bin
/opt/software/slurm/bin
/usr/local/bin
/usr/bin
/usr/local/sbin
/usr/sbin
/opt/puppetlabs/bin
/home/yourUsername/.local/bin
/home/yourUsername/bin</code></pre>
</div>
<p>Sin embargo, en nuestro caso tenemos una <code>python3</code>
existente disponible, así que vemos</p>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/cvmfs/pilot.eessi-hpc.org/2020.12/compat/linux/x86_64/usr/bin/python3</code></pre>
</div>
<p>Sin embargo, necesitamos un Python diferente al proporcionado por el
sistema, así que carguemos un módulo para acceder a él.</p>
<p>Podemos cargar el comando <code>python3</code> con
<code>module load</code>:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] module load Python</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] which python3</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/Python/3.x.y-GCCcore-x.y.z/bin/python3</code></pre>
</div>
<p>¿Qué acaba de ocurrir?</p>
<p>Para entender la salida, primero necesitamos entender la naturaleza
de la variable de entorno <code>$PATH</code>.<code>$PATH</code> es una
variable de entorno especial que controla dónde busca software un
sistema UNIX. Específicamente <code>$PATH</code> es una lista de
directorios (separados por <code>:</code>) en los que el sistema
operativo busca un comando antes de rendirse y decirnos que no puede
encontrarlo. Como con todas las variables de entorno podemos imprimirla
usando <code>echo</code>.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] echo <span class="va">$PATH</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/Python/3.x.y-GCCcore-x.y.z/bin:/cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/SQLite/3.31.1-GCCcore-x.y.z/bin:/cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/Tcl/8.6.10-GCCcore-x.y.z/bin:/cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/GCCcore/x.y.z/bin:/cvmfs/pilot.eessi-hpc.org/2020.12/compat/linux/x86_64/usr/bin:/opt/software/slurm/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/puppetlabs/bin:/home/user01/.local/bin:/home/user01/bin</code></pre>
</div>
<p>Notará una similitud con la salida del comando <code>which</code>. En
este caso, sólo hay una diferencia: el directorio diferente al
principio. Cuando ejecutamos el comando <code>module load</code>, se
añadió un directorio al principio de nuestro <code>$PATH</code>.
Examinemos lo que hay allí:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] ls /cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/Python/3.x.y-GCCcore-x.y.z/bin</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>2to3              nosetests-3.8  python                 rst2s5.py
2to3-3.8          pasteurize     python3                rst2xetex.py
chardetect        pbr            python3.8              rst2xml.py
cygdb             pip            python3.8-config       rstpep2html.py
cython            pip3           python3-config         runxlrd.py
cythonize         pip3.8         rst2html4.py           sphinx-apidoc
easy_install      pybabel        rst2html5.py           sphinx-autogen
easy_install-3.8  __pycache__    rst2html.py            sphinx-build
futurize          pydoc3         rst2latex.py           sphinx-quickstart
idle3             pydoc3.8       rst2man.py             tabulate
idle3.8           pygmentize     rst2odt_prepstyles.py  virtualenv
netaddr           pytest         rst2odt.py             wheel
nosetests         py.test        rst2pseudoxml.py</code></pre>
</div>
<p>Llevando esto a su conclusión, <code>module load</code> añadirá
software a su <code>$PATH</code>. Carga” software. Una nota especial
sobre esto - dependiendo de la versión del programa <code>module</code>
que esté instalado en su sitio, <code>module load</code> también cargará
las dependencias de software necesarias.</p>
<p>Para demostrarlo, utilicemos
<code>module list</code>.<code>module list</code> muestra todos los
módulos de software cargados.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] module list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currently Loaded Modules:
  1) GCCcore/x.y.z                 4) GMP/6.2.0-GCCcore-x.y.z
  2) Tcl/8.6.10-GCCcore-x.y.z      5) libffi/3.3-GCCcore-x.y.z
  3) SQLite/3.31.1-GCCcore-x.y.z   6) Python/3.x.y-GCCcore-x.y.z</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] module load GROMACS</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] module list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currently Loaded Modules:
  1) GCCcore/x.y.z                    14) libfabric/1.11.0-GCCcore-x.y.z
  2) Tcl/8.6.10-GCCcore-x.y.z         15) PMIx/3.1.5-GCCcore-x.y.z
  3) SQLite/3.31.1-GCCcore-x.y.z      16) OpenMPI/4.0.3-GCC-x.y.z
  4) GMP/6.2.0-GCCcore-x.y.z          17) OpenBLAS/0.3.9-GCC-x.y.z
  5) libffi/3.3-GCCcore-x.y.z         18) gompi/2020a
  6) Python/3.x.y-GCCcore-x.y.z       19) FFTW/3.3.8-gompi-2020a
  7) GCC/x.y.z                        20) ScaLAPACK/2.1.0-gompi-2020a
  8) numactl/2.0.13-GCCcore-x.y.z     21) foss/2020a
  9) libxml2/2.9.10-GCCcore-x.y.z     22) pybind11/2.4.3-GCCcore-x.y.z-Pytho...
 10) libpciaccess/0.16-GCCcore-x.y.z  23) SciPy-bundle/2020.03-foss-2020a-Py...
 11) hwloc/2.2.0-GCCcore-x.y.z        24) networkx/2.4-foss-2020a-Python-3.8...
 12) libevent/2.1.11-GCCcore-x.y.z    25) GROMACS/2020.1-foss-2020a-Python-3...
 13) UCX/1.8.0-GCCcore-x.y.z</code></pre>
</div>
<p>En este caso, al cargar el módulo <code>GROMACS</code> (un paquete de
software bioinformático), también se han cargado
<code>GMP/6.2.0-GCCcore-x.y.z</code> y
<code>SciPy-bundle/2020.03-foss-2020a-Python-3.x.y</code>. Intentemos
descargar el paquete <code>GROMACS</code>.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] module unload GROMACS</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] module list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currently Loaded Modules:
  1) GCCcore/x.y.z                    13) UCX/1.8.0-GCCcore-x.y.z
  2) Tcl/8.6.10-GCCcore-x.y.z         14) libfabric/1.11.0-GCCcore-x.y.z
  3) SQLite/3.31.1-GCCcore-x.y.z      15) PMIx/3.1.5-GCCcore-x.y.z
  4) GMP/6.2.0-GCCcore-x.y.z          16) OpenMPI/4.0.3-GCC-x.y.z
  5) libffi/3.3-GCCcore-x.y.z         17) OpenBLAS/0.3.9-GCC-x.y.z
  6) Python/3.x.y-GCCcore-x.y.z       18) gompi/2020a
  7) GCC/x.y.z                        19) FFTW/3.3.8-gompi-2020a
  8) numactl/2.0.13-GCCcore-x.y.z     20) ScaLAPACK/2.1.0-gompi-2020a
  9) libxml2/2.9.10-GCCcore-x.y.z     21) foss/2020a
 10) libpciaccess/0.16-GCCcore-x.y.z  22) pybind11/2.4.3-GCCcore-x.y.z-Pytho...
 11) hwloc/2.2.0-GCCcore-x.y.z        23) SciPy-bundle/2020.03-foss-2020a-Py...
 12) libevent/2.1.11-GCCcore-x.y.z    24) networkx/2.4-foss-2020a-Python-3.x.y</code></pre>
</div>
<p>Así que usar <code>module unload</code> “descarga” un módulo, y
dependiendo de cómo esté configurado un sitio puede que también
descargue todas las dependencias (en nuestro caso no lo hace). Si
quisiéramos descargar todo a la vez, podríamos ejecutar
<code>module purge</code> (descarga todo).</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] module purge</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] module list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>No modules loaded</code></pre>
</div>
<p>Tenga en cuenta que <code>module purge</code> es informativa. También
nos permitirá saber si un conjunto predeterminado de paquetes
“pegajosos” no puede ser descargado (y cómo descargarlos si realmente lo
deseamos).</p>
<p>Tenga en cuenta que este proceso de carga de módulos se produce
principalmente a través de la manipulación de variables de entorno como
<code>$PATH</code>. Normalmente hay poca o ninguna transferencia de
datos implicada.</p>
<p>El proceso de carga de módulos manipula también otras variables de
entorno especiales, incluyendo variables que influyen en dónde busca el
sistema las bibliotecas de software, y a veces variables que indican a
los paquetes de software comercial dónde encontrar los servidores de
licencias.</p>
<p>El comando module también restaura estas variables de entorno del
shell a su estado anterior cuando se descarga un módulo.</p>
</section><section><h2 class="section-heading" id="versiones-de-software">Versiones de software<a class="anchor" aria-label="anchor" href="#versiones-de-software"></a>
</h2>
<hr class="half-width">
<p>Hasta ahora, hemos aprendido cómo cargar y descargar paquetes de
software. Esto es muy útil. Sin embargo, aún no hemos abordado la
cuestión del versionado de software. En un momento u otro, te
encontrarás con problemas en los que sólo una versión concreta de algún
software será adecuada. Puede que un error clave sólo se haya corregido
en una versión determinada, o que la versión X haya roto la
compatibilidad con un formato de archivo que utilizas. En cualquiera de
estos casos, ayuda ser muy específico sobre el software que se
carga.</p>
<p>Examinemos la salida de <code>module avail</code> más de cerca.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] module avail</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>~~~ /cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/modules/all ~~~
  Bazel/3.6.0-GCCcore-x.y.z              NSS/3.51-GCCcore-x.y.z
  Bison/3.5.3-GCCcore-x.y.z              Ninja/1.10.0-GCCcore-x.y.z
  Boost/1.72.0-gompi-2020a               OSU-Micro-Benchmarks/5.6.3-gompi-2020a
  CGAL/4.14.3-gompi-2020a-Python-3.x.y   OpenBLAS/0.3.9-GCC-x.y.z
  CMake/3.16.4-GCCcore-x.y.z             OpenFOAM/v2006-foss-2020a

[removed most of the output here for clarity]

  Where:
   L:        Module is loaded
   Aliases:  Aliases exist: foo/1.2.3 (1.2) means that "module load foo/1.2"
             will load foo/1.2.3
   D:        Default Module

Use "module spider" to find all possible modules and extensions.
Use "module keyword key1 key2 ..." to search for all possible modules matching
any of the "keys".</code></pre>
</div>
<div id="uso-de-módulos-de-software-en-scripts" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="uso-de-módulos-de-software-en-scripts" class="callout-inner">
<h3 class="callout-title">Uso de módulos de software en scripts</h3>
<div class="callout-content">
<p>Crea un trabajo capaz de ejecutar <code>python3 --version</code>.
Recuerde, ¡no se carga ningún software por defecto! Ejecutar un trabajo
es como iniciar sesión en el sistema (no debe asumir que un módulo
cargado en el nodo de inicio de sesión está cargado en un nodo de
computación).</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Solución
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] nano python-module.sh</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat python-module.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>#!/bin/bash
#SBATCH
r config$sched$comment` -t 00:00:30

module load Python

python3 --version</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch  python-module.sh</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul>
<li>Cargar software con <code>module load softwareName</code>.</li>
<li>Descargar software con <code>module unload</code>
</li>
<li>El sistema de módulos gestiona automáticamente las versiones de
software y los conflictos entre paquetes.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-16-transferring-files"><p>Content from <a href="16-transferring-files.html">Transferencia de archivos con ordenadores remotos</a></p>
<hr>
<p>Última actualización: 2025-08-04 |

        <a href="https://github.com/ocaisa/probable-pancake/edit/main/episodes/16-transferring-files.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Tiempo estimado: <i aria-hidden="true" data-feather="clock"></i> 30 minutos</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo transfiero archivos a (y desde) el cluster?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<ul>
<li>Transfiere archivos hacia y desde un clúster informático.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Realizar trabajo en un ordenador remoto no es muy útil si no podemos
obtener ficheros hacia o desde el cluster. Existen varias opciones para
transferir datos entre recursos informáticos utilizando utilidades CLI y
GUI, algunas de las cuales veremos a continuación.</p>
<section><h2 class="section-heading" id="descargar-archivos-de-lecciones-de-internet">Descargar archivos de lecciones de Internet<a class="anchor" aria-label="anchor" href="#descargar-archivos-de-lecciones-de-internet"></a>
</h2>
<hr class="half-width">
<p>Una de las formas más sencillas de descargar archivos es utilizar
<code>curl</code> o <code>wget</code>. Uno de ellos suele estar
instalado en la mayoría de los shells de Linux, en el terminal de Mac OS
y en GitBash. Cualquier archivo que pueda descargarse en su navegador
web a través de un enlace directo puede descargarse utilizando
<code>curl</code> o <code>wget</code>. Esta es una forma rápida de
descargar conjuntos de datos o código fuente. La sintaxis de estos
comandos es</p>
<ul>
<li><code>wget [-O new_name] https://some/link/to/a/file</code></li>
<li><code>curl [-o new_name] https://some/link/to/a/file</code></li>
</ul>
<p>Pruébalo descargando algún material que usaremos más adelante, desde
un terminal en tu máquina local, usando la URL de la base de código
actual:</p>
<p><a href="https://github.com/hpc-carpentry/amdahl/tarball/main" class="external-link uri">https://github.com/hpc-carpentry/amdahl/tarball/main</a></p>
<div id="descarga-el-tarball" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="descarga-el-tarball" class="callout-inner">
<h3 class="callout-title">Descarga el “Tarball”</h3>
<div class="callout-content">
<p>La palabra “tarball” en la URL anterior se refiere a un formato de
archivo comprimido comúnmente utilizado en Linux, que es el sistema
operativo que ejecutan la mayoría de las máquinas de clúster HPC. Un
tarball es muy parecido a un archivo <code>.zip</code>. La extensión
real del archivo es <code>.tar.gz</code>, que refleja el proceso en dos
etapas utilizado para crearlo: los archivos o carpetas se fusionan en un
único archivo utilizando <code>tar</code>, que luego se comprime
utilizando <code>gzip</code>, por lo que la extensión del archivo es
“tar-dot-g-z” Es un trabalenguas, así que la gente suele decir “el
tarball <em>xyz</em>” en su lugar.</p>
<p>También puede ver la extensión <code>.tgz</code>, que no es más que
una abreviatura de <code>.tar.gz</code>.</p>
<p>Por defecto, <code>curl</code> y <code>wget</code> descargan los
archivos con el mismo nombre que la URL: en este caso,
<code>main</code>. Utilice uno de los comandos anteriores para guardar
el tarball como <code>amdahl.tar.gz</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Comandos wget y curl
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> wget <span class="at">-O</span> amdahl.tar.gz https://github.com/hpc-carpentry/amdahl/tarball/main</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> curl <span class="at">-o</span> amdahl.tar.gz <span class="at">-L</span> https://github.com/hpc-carpentry/amdahl/tarball/main</span></code></pre>
</div>
<p>La opción <code>-L</code> para <code>curl</code> le dice que siga las
redirecciones URL (lo que <code>wget</code> hace por defecto).</p>
</div>
</div>
</div>
</div>
<p>Después de descargar el archivo, utilice <code>ls</code> para verlo
en su directorio de trabajo:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ls</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="archivar-ficheros">Archivar ficheros<a class="anchor" aria-label="anchor" href="#archivar-ficheros"></a>
</h2>
<hr class="half-width">
<p>Uno de los mayores retos a los que nos enfrentamos a menudo cuando
transferimos datos entre sistemas HPC remotos es el de un gran número de
archivos. Hay una sobrecarga en la transferencia de cada archivo
individual y cuando estamos transfiriendo un gran número de archivos
estas sobrecargas se combinan para ralentizar nuestras transferencias en
gran medida.</p>
<p>La solución a este problema es <em>archivar</em> múltiples ficheros
en números más pequeños de ficheros más grandes antes de transferir los
datos para mejorar nuestra eficiencia de transferencia. A veces
combinaremos el archivado con la <em>compresión</em> para reducir la
cantidad de datos que tenemos que transferir y así acelerar la
transferencia. El comando de archivado más común en un cluster HPC
(Linux) es <code>tar</code>.</p>
<p><code>tar</code> puede utilizarse para combinar ficheros y carpetas
en un único fichero de archivo y, opcionalmente, comprimir el resultado.
Veamos el archivo que descargamos del sitio de la lección,
<code>amdahl.tar.gz</code>.</p>
<p>La parte <code>.gz</code> significa <em>gzip</em>, que es una
biblioteca de compresión. Es común (¡pero no necesario!) que este tipo
de archivo pueda interpretarse leyendo su nombre: parece que alguien
tomó archivos y carpetas relacionados con algo llamado “amdahl”, los
envolvió todos en un único archivo con <code>tar</code>, y luego
comprimió ese archivo con <code>gzip</code> para ahorrar espacio.</p>
<p>Veamos si es el caso, <em>sin</em> descomprimir el archivo.
<code>tar</code> imprime el “<strong>t</strong>able de contenidos” con
la bandera <code>-t</code>, para el fichero especificado con la bandera
<code>-f</code> seguido del nombre del fichero. Tenga en cuenta que
puede concatenar las dos banderas: escribir <code>-t -f</code> es
intercambiable con escribir <code>-tf</code> juntas. Sin embargo, el
argumento que sigue a <code>-f</code> debe ser un nombre de fichero, por
lo que escribir <code>-ft</code> <em>no</em> funcionará.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> tar <span class="at">-tf</span> amdahl.tar.gz</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/.github/</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/.github/workflows/</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/.github/workflows/python-publish.yml</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/.gitignore</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/LICENSE</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/README.md</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/amdahl/</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/amdahl/__init__.py</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/amdahl/__main__.py</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/amdahl/amdahl.py</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/requirements.txt</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/setup.py</span></span></code></pre>
</div>
<p>Este ejemplo muestra una carpeta que contiene algunos archivos, donde
<code>46c9b4b</code> es un hash de confirmación <a href="https://swcarpentry.github.io/git-novice/" class="external-link">git</a> de 8 caracteres
que cambiará cuando se actualice el material fuente.</p>
<p>Ahora vamos a descomprimir el archivo. Ejecutaremos <code>tar</code>
con algunas banderas comunes:</p>
<ul>
<li>
<code>-x</code> para e<strong>x</strong>traer el archivo</li>
<li>
<code>-v</code> para una salida <strong>v</strong>erbosa</li>
<li>
<code>-z</code> para compresión g<strong>z</strong>ip</li>
<li>
<code>-f «tarball»</code> para el fichero a descomprimir</li>
</ul>
<div id="extraer-el-archivo" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="extraer-el-archivo" class="callout-inner">
<h3 class="callout-title">Extraer el archivo</h3>
<div class="callout-content">
<p>Usando las banderas de arriba, desempaquete el tarball del código
fuente en un nuevo directorio llamado “amdahl” usando
<code>tar</code>.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> tar <span class="at">-xvzf</span> amdahl.tar.gz</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>hpc-carpentry-amdahl-46c9b4b/
hpc-carpentry-amdahl-46c9b4b/.github/
hpc-carpentry-amdahl-46c9b4b/.github/workflows/
hpc-carpentry-amdahl-46c9b4b/.github/workflows/python-publish.yml
hpc-carpentry-amdahl-46c9b4b/.gitignore
hpc-carpentry-amdahl-46c9b4b/LICENSE
hpc-carpentry-amdahl-46c9b4b/README.md
hpc-carpentry-amdahl-46c9b4b/amdahl/
hpc-carpentry-amdahl-46c9b4b/amdahl/__init__.py
hpc-carpentry-amdahl-46c9b4b/amdahl/__main__.py
hpc-carpentry-amdahl-46c9b4b/amdahl/amdahl.py
hpc-carpentry-amdahl-46c9b4b/requirements.txt
hpc-carpentry-amdahl-46c9b4b/setup.py</code></pre>
</div>
<p>Observe que no necesitamos teclear <code>-x -v -z -f</code>, gracias
a la concatenación de banderas, aunque el comando funciona de forma
idéntica de cualquier forma – siempre que la lista concatenada termine
con <code>f</code>, porque la siguiente cadena debe especificar el
nombre del fichero a extraer.</p>
</div>
</div>
</div>
<p>La carpeta tiene un nombre desafortunado, así que cambiémoslo por
algo más conveniente.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> mv hpc-carpentry-amdahl-46c9b4b amdahl</span></code></pre>
</div>
<p>Comprueba el tamaño del directorio extraído y compáralo con el tamaño
del archivo comprimido, utilizando <code>du</code> para
“<strong>d</strong>isk <strong>u</strong>sage”.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> du <span class="at">-sh</span> amdahl.tar.gz</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">8.0K</span>     amdahl.tar.gz</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> du <span class="at">-sh</span> amdahl</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="ex">48K</span>    amdahl</span></code></pre>
</div>
<p>Los archivos de texto (incluido el código fuente de Python) se
comprimen muy bien: ¡el “tarball” es una sexta parte del tamaño total de
los datos en bruto!</p>
<p>Si desea invertir el proceso – comprimir los datos en bruto en lugar
de extraerlos – establezca una bandera <code>c</code> en lugar de
<code>x</code>, establezca el nombre del fichero de archivo, y luego
proporcione un directorio para comprimir:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> tar <span class="at">-cvzf</span> compressed_code.tar.gz amdahl</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>amdahl/
amdahl/.github/
amdahl/.github/workflows/
amdahl/.github/workflows/python-publish.yml
amdahl/.gitignore
amdahl/LICENSE
amdahl/README.md
amdahl/amdahl/
amdahl/amdahl/__init__.py
amdahl/amdahl/__main__.py
amdahl/amdahl/amdahl.py
amdahl/requirements.txt
amdahl/setup.py</code></pre>
</div>
<p>Si das <code>amdahl.tar.gz</code> como nombre de fichero en el
comando anterior, <code>tar</code> actualizará el tarball existente con
cualquier cambio que hayas hecho en los ficheros. Eso significaría
añadir la nueva carpeta <code>amdahl</code> a la carpeta
<em>existente</em> (<code>hpc-carpentry-amdahl-46c9b4b</code>) dentro
del tarball, ¡duplicando el tamaño del archivo!</p>
<div id="trabajando-con-windows" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="trabajando-con-windows" class="callout-inner">
<h3 class="callout-title">Trabajando con Windows</h3>
<div class="callout-content">
<p>Cuando transfieres ficheros de texto de un sistema Windows a un
sistema Unix (Mac, Linux, BSD, Solaris, etc.) esto puede causar
problemas. Windows codifica sus ficheros de forma ligeramente diferente
a Unix, y añade un carácter extra a cada línea.</p>
<p>En un sistema Unix, cada línea de un archivo termina con una
<code>\n</code> (nueva línea). En Windows, cada línea de un archivo
termina con <code>\r\n</code> (retorno de carro + nueva línea). Esto a
veces causa problemas.</p>
<p>Aunque la mayoría de los lenguajes de programación y software
modernos manejan esto correctamente, en algunos casos raros, puede
encontrarse con un problema. La solución es convertir un archivo de
Windows a la codificación Unix con el comando <code>dos2unix</code>.</p>
<p>Puede identificar si un fichero tiene terminaciones de línea Windows
con <code>cat -A filename</code>. Un fichero con terminaciones de línea
Windows tendrá <code>^M$</code> al final de cada línea. Un fichero con
terminaciones de línea Unix tendrá <code>$</code> al final de cada
línea.</p>
<p>Para convertir el archivo, basta con ejecutar
<code>dos2unix filename</code>. (A la inversa, para volver a convertirlo
al formato de Windows, puede ejecutar
<code>unix2dos filename</code>)</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="transferencia-de-archivos-y-carpetas-con-scp">Transferencia de archivos y carpetas con <code>scp</code>
<a class="anchor" aria-label="anchor" href="#transferencia-de-archivos-y-carpetas-con-scp"></a>
</h2>
<hr class="half-width">
<p>Para copiar un único fichero hacia o desde el cluster, podemos
utilizar <code>scp</code> (“copia segura”). La sintaxis puede resultar
un poco compleja para los nuevos usuarios, pero vamos a desglosarla. El
comando <code>scp</code> es un pariente del comando <code>ssh</code> que
utilizamos para acceder al sistema, y puede utilizar el mismo mecanismo
de autenticación de clave pública.</p>
<p>Para <em>cargar a</em> otro ordenador, el comando de plantilla es</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> scp local_file yourUsername@cluster.hpc-carpentry.org:remote_destination</span></code></pre>
</div>
<p>en el que <code>@</code> y <code>:</code> son separadores de campo y
<code>remote_destination</code> es una ruta relativa a su directorio
personal remoto, o un nuevo nombre de fichero si desea cambiarlo, o
ambos una ruta relativa <em>y</em> un nuevo nombre de fichero. Si no
tiene una carpeta específica en mente, puede omitir
<code>remote_destination</code> y el archivo se copiará a su directorio
personal en el ordenador remoto (con su nombre original). Si incluye
<code>remote_destination</code>, tenga en cuenta que <code>scp</code> lo
interpreta de la misma forma que <code>cp</code> cuando hace copias
locales: si existe y es una carpeta, el fichero se copia dentro de la
carpeta; si existe y es un fichero, el fichero se sobrescribe con el
contenido de <code>local_file</code>; si no existe, se asume que es un
nombre de fichero de destino para <code>local_file</code>.</p>
<p>Sube el material de la lección a tu directorio personal remoto de
esta forma:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> scp amdahl.tar.gz yourUsername@cluster.hpc-carpentry.org:</span></code></pre>
</div>
<div id="por-qué-no-descargar-en-hpc-carpentrys-cloud-cluster-directamente" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="por-qué-no-descargar-en-hpc-carpentrys-cloud-cluster-directamente" class="callout-inner">
<h3 class="callout-title">¿Por qué no descargar en HPC Carpentry’s Cloud Cluster directamente?</h3>
<div class="callout-content">
<p>La mayoría de los clusters de ordenadores están protegidos de la
Internet abierta por un <em>firewall</em>. Para mejorar la seguridad,
algunos están configurados para permitir el tráfico <em>entrante</em>,
pero no <em>saliente</em>. Esto significa que un usuario autentificado
puede enviar un fichero a una máquina del cluster, pero una máquina del
cluster no puede recuperar ficheros de la máquina de un usuario o de la
Internet abierta.</p>
<p>Intente descargar el archivo directamente. Tenga en cuenta que puede
fallar, ¡y no pasa nada!</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Comandos
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh yourUsername@cluster.hpc-carpentry.org</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] wget <span class="at">-O</span> amdahl.tar.gz https://github.com/hpc-carpentry/amdahl/tarball/main</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] curl <span class="at">-o</span> amdahl.tar.gz https://github.com/hpc-carpentry/amdahl/tarball/main</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="por-qué-no-descargar-en-hpc-carpentrys-cloud-cluster-directamente" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="por-qué-no-descargar-en-hpc-carpentrys-cloud-cluster-directamente" class="callout-inner">
<h3 class="callout-title">¿Por qué no descargar en HPC Carpentry’s Cloud
Cluster directamente?<em> (continued)</em>
</h3>
<div class="callout-content">
<p>¿Funcionó? Si no, ¿qué te dice la salida del terminal sobre lo que ha
pasado?</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="transferir-un-directorio">Transferir un directorio<a class="anchor" aria-label="anchor" href="#transferir-un-directorio"></a>
</h2>
<hr class="half-width">
<p>Para transferir un directorio entero, añadimos la bandera
<code>-r</code> para “<strong>r</strong>ecursivo”: copia el elemento
especificado, y cada elemento por debajo de él, y cada elemento por
debajo de esos… hasta que llegue al fondo del árbol de directorios
enraizado en el nombre de carpeta que proporcionaste.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> scp <span class="at">-r</span> amdahl yourUsername@cluster.hpc-carpentry.org:</span></code></pre>
</div>
<div id="precaución" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="precaución" class="callout-inner">
<h3 class="callout-title">Precaución</h3>
<div class="callout-content">
<p>Para un directorio grande – ya sea en tamaño o en número de ficheros
– copiar con <code>-r</code> puede tardar mucho tiempo en
completarse.</p>
</div>
</div>
</div>
<p>Cuando utilice <code>scp</code>, habrá notado que <code>:</code>
<em>siempre</em> sigue al nombre del ordenador remoto. Una cadena
<em>después</em> de <code>:</code> especifica el directorio remoto al
que desea transferir el archivo o carpeta, incluyendo un nuevo nombre si
desea renombrar el material remoto. Si deja este campo en blanco,
<code>scp</code> por defecto será su directorio personal y el nombre del
material local a transferir.</p>
<p>En los ordenadores Linux, <code>/</code> es el separador en las rutas
de archivos o directorios. Una ruta que comienza con <code>/</code> se
llama <em>absoluta</em>, ya que no puede haber nada por encima de la
raíz <code>/</code>. Una ruta que no empieza por <code>/</code> se llama
<em>relativa</em>, ya que no está anclada a la raíz.</p>
<p>Si quiere subir un fichero a una ubicación dentro de su directorio
personal – lo que suele ser el caso – entonces no necesita un
<code>/</code> <em>líder</em>. Después de <code>:</code>, puede escribir
la ruta de destino relativa a su directorio personal. Si su directorio
personal <em>es</em> el destino, puede dejar el campo de destino en
blanco, o escribir <code>~</code> – la abreviatura de su directorio
personal – para completar.</p>
<p>Con <code>scp</code>, una barra al final del directorio de destino es
opcional y no tiene ningún efecto. Una barra al final del directorio de
origen es importante para otros comandos, como <code>rsync</code>.</p>
<div id="nota-sobre-rsync" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="nota-sobre-rsync" class="callout-inner">
<h3 class="callout-title">Nota sobre <code>rsync</code>
</h3>
<div class="callout-content">
<p>A medida que adquiera experiencia en la transferencia de archivos,
puede que el comando <code>scp</code> le resulte limitante. La utilidad
<a href="https://rsync.samba.org/" class="external-link">rsync</a> proporciona características
avanzadas para la transferencia de archivos y es normalmente más rápida
comparada con <code>scp</code> y <code>sftp</code> (ver más abajo). Es
especialmente útil para transferir archivos grandes y/o numerosos y para
sincronizar el contenido de carpetas entre ordenadores.</p>
<p>La sintaxis es similar a <code>scp</code>. Para transferir <em>a</em>
otro ordenador con opciones de uso común:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> rsync <span class="at">-avP</span> amdahl.tar.gz yourUsername@cluster.hpc-carpentry.org:</span></code></pre>
</div>
<p>Las opciones son:</p>
<ul>
<li>
<code>-a</code> (<strong>a</strong>rchivo) para preservar las marcas
de tiempo de los archivos, los permisos y las carpetas, entre otras
cosas; implica recursión</li>
<li>
<code>-v</code> (<strong>v</strong>erbose) para obtener una salida
detallada que le ayude a monitorizar la transferencia</li>
<li>
<code>-P</code> (<strong>p</strong>artial/progress) para preservar
los archivos parcialmente transferidos en caso de interrupción y también
muestra el progreso de la transferencia.</li>
</ul>
<p>Para copiar recursivamente un directorio, podemos utilizar las mismas
opciones:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> rsync <span class="at">-avP</span> amdahl yourUsername@cluster.hpc-carpentry.org:~/</span></code></pre>
</div>
<p>Tal y como está escrito, esto colocará el directorio local y su
contenido bajo tu directorio personal en el sistema remoto. Si se añade
una barra al final del origen, no se creará un nuevo directorio
correspondiente al directorio transferido, y el contenido del directorio
de origen se copiará directamente en el directorio de destino.</p>
<p>Para descargar un archivo, simplemente cambiamos el origen y el
destino:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> rsync <span class="at">-avP</span> yourUsername@cluster.hpc-carpentry.org:amdahl ./</span></code></pre>
</div>
</div>
</div>
</div>
<p>Las transferencias de ficheros utilizando tanto <code>scp</code> como
<code>rsync</code> utilizan SSH para encriptar los datos enviados a
través de la red. Por lo tanto, si puede conectarse a través de SSH,
podrá transferir archivos. Por defecto, SSH utiliza el puerto de red 22.
Si se está utilizando un puerto SSH personalizado, tendrá que
especificarlo utilizando la bandera apropiada, a menudo <code>-p</code>,
<code>-P</code>, o <code>--port</code>. Comprueba <code>--help</code> o
la página <code>man</code> si no estás seguro.</p>
<div id="cambiar-el-puerto-rsync" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="cambiar-el-puerto-rsync" class="callout-inner">
<h3 class="callout-title">Cambiar el puerto Rsync</h3>
<div class="callout-content">
<p>Supongamos que tenemos que conectarnos a <code>rsync</code> a través
del puerto 768 en lugar del 22. ¿Cómo modificaríamos este comando?</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> rsync amdahl.tar.gz yourUsername@cluster.hpc-carpentry.org:</span></code></pre>
</div>
<p><em>Pista:</em> consulte la página <code>man</code> o la “ayuda” para
<code>rsync</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Solución
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> man rsync</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> rsync <span class="at">--help</span> <span class="kw">|</span> <span class="fu">grep</span> port</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>     <span class="ex">--port=PORT</span>             specify double-colon alternate port number</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="ex">See</span> http://rsync.samba.org/ for updates, bug reports, and answers</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> rsync <span class="at">--port</span><span class="op">=</span>768 amdahl.tar.gz yourUsername@cluster.hpc-carpentry.org:</span></code></pre>
</div>
<p>(Tenga en cuenta que este comando fallará, ya que el puerto correcto
en este caso es el predeterminado: 22.)</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="transferencia-interactiva-de-archivos-con-filezilla">Transferencia interactiva de archivos con FileZilla<a class="anchor" aria-label="anchor" href="#transferencia-interactiva-de-archivos-con-filezilla"></a>
</h2>
<hr class="half-width">
<p>FileZilla es un cliente multiplataforma para descargar y subir
archivos a y desde un ordenador remoto. Es absolutamente infalible y
siempre funciona bastante bien. Utiliza el protocolo <code>sftp</code>.
Puede leer más sobre el uso del protocolo <code>sftp</code> en la línea
de comandos en la <a href="discuss.html">discusión de la
lección</a>.</p>
<p>Descargue e instale el cliente FileZilla desde <a href="https://filezilla-project.org" class="external-link uri">https://filezilla-project.org</a>. Tras instalar y abrir el
programa, debería aparecer una ventana con un explorador de archivos de
su sistema local en la parte izquierda de la pantalla. Cuando te
conectes al cluster, los archivos de tu cluster aparecerán en la parte
derecha.</p>
<p>Para conectarnos al cluster, sólo tendremos que introducir nuestras
credenciales en la parte superior de la pantalla:</p>
<ul>
<li>Host: <code>sftp://cluster.hpc-carpentry.org</code>
</li>
<li>Usuario: Su nombre de usuario del cluster</li>
<li>Contraseña: Su contraseña del clúster</li>
<li>Puerto: (déjelo en blanco para usar el puerto por defecto)</li>
</ul>
<p>Pulsa “Quickconnect” para conectarte. Deberías ver tus archivos
remotos aparecer en la parte derecha de la pantalla. Puedes arrastrar y
soltar archivos entre los lados izquierdo (local) y derecho (remoto) de
la pantalla para transferir archivos.</p>
<p>Por último, si necesita mover archivos grandes (normalmente de más de
un gigabyte) de un ordenador remoto a otro remoto, acceda mediante SSH
al ordenador que aloja los archivos y utilice <code>scp</code> o
<code>rsync</code> para transferirlos al otro. Esto será más eficiente
que usar FileZilla (o aplicaciones relacionadas) que copiarían de la
fuente a su máquina local, y luego a la máquina de destino.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul>
<li>
<code>wget</code> y <code>curl -O</code> descarga un archivo de
Internet.</li>
<li>
<code>scp</code> y <code>rsync</code> transfieren archivos desde y
hacia su ordenador.</li>
<li>Puede utilizar un cliente SFTP como FileZilla para transferir
archivos a través de una GUI.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-17-parallel"><p>Content from <a href="17-parallel.html">Ejecutar un trabajo paralelo</a></p>
<hr>
<p>Última actualización: 2025-08-04 |

        <a href="https://github.com/ocaisa/probable-pancake/edit/main/episodes/17-parallel.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Tiempo estimado: <i aria-hidden="true" data-feather="clock"></i> 90 minutos</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo se ejecuta una tarea en paralelo?</li>
<li>¿Qué ventajas aporta la ejecución en paralelo?</li>
<li>¿Cuáles son los límites de las ganancias de la ejecución en
paralelo?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<ul>
<li>Instale un paquete Python usando <code>pip</code>
</li>
<li>Prepara un script de envío de trabajos para el ejecutable
paralelo.</li>
<li>Lanzar trabajos con ejecución paralela.</li>
<li>Registrar y resumir el tiempo y la precisión de los trabajos.</li>
<li>Describa la relación entre el paralelismo de trabajos y el
rendimiento.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Ahora tenemos las herramientas que necesitamos para ejecutar un
trabajo multiprocesador. Este es un aspecto muy importante de los
sistemas HPC, ya que el paralelismo es una de las principales
herramientas que tenemos para mejorar el rendimiento de las tareas
computacionales.</p>
<p>Si se desconectó, vuelva a conectarse al clúster.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh yourUsername@cluster.hpc-carpentry.org</span></code></pre>
</div>
<section><h2 class="section-heading" id="instalar-el-programa-amdahl">Instalar el programa Amdahl<a class="anchor" aria-label="anchor" href="#instalar-el-programa-amdahl"></a>
</h2>
<hr class="half-width">
<p>Con el código fuente de Amdahl en el cluster, podemos instalarlo, lo
que nos dará acceso al ejecutable <code>amdahl</code>. Muévete al
directorio extraído, y luego utiliza el Instalador de Paquetes para
Python, o <code>pip</code>, para instalarlo en tu directorio personal
(“usuario”):</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cd amdahl</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] python3 <span class="at">-m</span> pip install <span class="at">--user</span> .</span></code></pre>
</div>
<div id="amdahl-es-código-python" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="amdahl-es-código-python" class="callout-inner">
<h3 class="callout-title">Amdahl es código Python</h3>
<div class="callout-content">
<p>El programa Amdahl está escrito en Python, e instalarlo o utilizarlo
requiere localizar el ejecutable <code>python3</code> en el nodo de
inicio de sesión. Si no puede encontrarlo, intente listar los módulos
disponibles usando <code>module avail</code>, cargue el apropiado, e
intente el comando de nuevo.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="mpi-para-python">MPI para Python<a class="anchor" aria-label="anchor" href="#mpi-para-python"></a>
</h3>
<p>El código Amdahl tiene una dependencia: <strong>mpi4py</strong>. Si
aún no ha sido instalado en el cluster, <code>pip</code> intentará
recoger mpi4py de Internet e instalarlo por ti. Si esto falla debido a
un cortafuegos unidireccional, deberás recuperar mpi4py en tu máquina
local y subirlo, tal y como hicimos para Amdahl.</p>
<div id="recuperar-y-subir-mpi4py" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="recuperar-y-subir-mpi4py" class="callout-inner">
<h3 class="callout-title">Recuperar y Subir <code>mpi4py</code>
</h3>
<div class="callout-content">
<p>Si la instalación de Amdahl falló porque mpi4py no pudo ser
instalado, recupere el tarball de <a href="https://github.com/mpi4py/mpi4py/tarball/master" class="external-link uri">https://github.com/mpi4py/mpi4py/tarball/master</a> luego
<code>rsync</code> al cluster, extraiga, e instale:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> wget <span class="at">-O</span> mpi4py.tar.gz https://github.com/mpi4py/mpi4py/releases/download/3.1.4/mpi4py-3.1.4.tar.gz</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> scp mpi4py.tar.gz yourUsername@cluster.hpc-carpentry.org:</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> rsync <span class="at">-avP</span> mpi4py.tar.gz yourUsername@cluster.hpc-carpentry.org:</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">[you@laptop:~]$</span> ssh yourUsername@cluster.hpc-carpentry.org</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] tar <span class="at">-xvzf</span> mpi4py.tar.gz  <span class="co"># extract the archive</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] mv mpi4py<span class="pp">*</span> mpi4py        <span class="co"># rename the directory</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cd mpi4py</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] python3 <span class="at">-m</span> pip install <span class="at">--user</span> .</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cd ../amdahl</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] python3 <span class="at">-m</span> pip install <span class="at">--user</span> .</span></code></pre>
</div>
</div>
</div>
</div>
<div id="if-pip-raises-a-warning" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="if-pip-raises-a-warning" class="callout-inner">
<h3 class="callout-title">If <code>pip</code> Raises a Warning…</h3>
<div class="callout-content">
<p><code>pip</code> puede advertir que los binarios de su paquete de
usuario no están en su PATH.</p>
<div class="codewrapper">
<h3 class="code-label">ADVERTENCIA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>WARNING: The script amdahl is installed in "${HOME}/.local/bin" which is
not on PATH. Consider adding this directory to PATH or, if you prefer to
suppress this warning, use --no-warn-script-location.</code></pre>
</div>
<p>Para comprobar si esta advertencia es un problema, utilice
<code>which</code> para buscar el programa <code>amdahl</code>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] which amdahl</span></code></pre>
</div>
<p>Si el comando no devuelve ninguna salida, mostrando un nuevo prompt,
significa que no se ha encontrado el fichero <code>amdahl</code>. Debe
actualizar la variable de entorno llamada <code>PATH</code> para incluir
la carpeta que falta. Edite el archivo de configuración de su shell de
la siguiente manera, luego cierre la sesión en el cluster y vuelva a
iniciarla para que surta efecto.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] nano ~/.bashrc</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] tail ~/.bashrc</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>export PATH=${PATH}:${HOME}/.local/bin</code></pre>
</div>
<p>Después de volver a entrar en cluster.hpc-carpentry.org,
<code>which</code> debería ser capaz de encontrar <code>amdahl</code>
sin dificultades. Si ha tenido que cargar un módulo de Python, vuelva a
cargarlo.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="ayuda">¡Ayuda!<a class="anchor" aria-label="anchor" href="#ayuda"></a>
</h2>
<hr class="half-width">
<p>Muchos programas de línea de comandos incluyen un mensaje de “ayuda”.
Pruébelo con <code>amdahl</code>:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] amdahl <span class="at">--help</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>usage: amdahl [-h] [-p [PARALLEL_PROPORTION]] [-w [WORK_SECONDS]] [-t] [-e] [-j [JITTER_PROPORTION]]

optional arguments:
  -h, --help            show this help message and exit
  -p [PARALLEL_PROPORTION], --parallel-proportion [PARALLEL_PROPORTION]
                        Parallel proportion: a float between 0 and 1
  -w [WORK_SECONDS], --work-seconds [WORK_SECONDS]
                        Total seconds of workload: an integer greater than 0
  -t, --terse           Format output as a machine-readable object for easier analysis
  -e, --exact           Exactly match requested timing by disabling random jitter
  -j [JITTER_PROPORTION], --jitter-proportion [JITTER_PROPORTION]
                        Random jitter: a float between -1 and +1</code></pre>
</div>
<p>Este mensaje no nos dice mucho sobre lo que el programa
<em>hace</em>, pero sí nos dice las banderas importantes que podríamos
querer usar al lanzarlo.</p>
</section><section><h2 class="section-heading" id="ejecutando-el-trabajo-en-un-nodo-de-computación">Ejecutando el Trabajo en un Nodo de Computación<a class="anchor" aria-label="anchor" href="#ejecutando-el-trabajo-en-un-nodo-de-computaci%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>Crear un archivo de envío, solicitando una tarea en un único nodo, y
luego lanzarla.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] nano serial-job.sh</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat serial-job.sh</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#SBATCH -J solo-job</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#SBATCH -p cpubase_bycore_b1</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#SBATCH -N 1</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#SBATCH -n 1</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co"># Load the computing environment we need</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="ex">module</span> load Python</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co"># Execute the task</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="ex">amdahl</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch serial-job.sh</span></code></pre>
</div>
<p>Como antes, utilice los comandos de estado Slurm para comprobar si su
trabajo se está ejecutando y cuándo finaliza:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] squeue <span class="at">-u</span> yourUsername</span></code></pre>
</div>
<p>Utilice <code>ls</code> para localizar el fichero de salida. La
bandera <code>-t</code> ordena en orden cronológico inverso: el más
reciente primero. ¿Cuál fue la salida?</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  Leer la salida del trabajo
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>La salida del cluster debe escribirse en un fichero en la carpeta
desde la que lanzaste el trabajo. Por ejemplo,</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] ls <span class="at">-t</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>slurm-347087.out  serial-job.sh  amdahl  README.md  LICENSE.txt</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat slurm-347087.out</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Doing 30.000 seconds of 'work' on 1 processor,
which should take 30.000 seconds with 0.850 parallel proportion of the workload.

  Hello, World! I am process 0 of 1 on smnode1. I will do all the serial 'work' for 4.500 seconds.
  Hello, World! I am process 0 of 1 on smnode1. I will do parallel 'work' for 25.500 seconds.

Total execution time (according to rank 0): 30.033 seconds</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Como vimos antes, dos de las banderas del programa
<code>amdahl</code> establecen la cantidad de trabajo y la proporción de
ese trabajo que es de naturaleza paralela. Basándonos en la salida,
podemos ver que el código utiliza por defecto 30 segundos de trabajo que
es 85% paralelo. El programa se ejecutó durante algo más de 30 segundos
en total, y si hacemos números, es cierto que el 15% del mismo se marcó
como ‘serie’ y el 85% como ‘paralelo’.</p>
<p>Como sólo le dimos una CPU al trabajo, este trabajo no fue realmente
paralelo: el mismo procesador realizó el trabajo “en serie” durante 4,5
segundos, y luego la parte “paralela” durante 25,5 segundos, y no se
ahorró tiempo. El clúster puede hacerlo mejor, si se lo pedimos.</p>
</section><section><h2 class="section-heading" id="ejecutando-el-trabajo-paralelo">Ejecutando el Trabajo Paralelo<a class="anchor" aria-label="anchor" href="#ejecutando-el-trabajo-paralelo"></a>
</h2>
<hr class="half-width">
<p>El programa <code>amdahl</code> utiliza la Interfaz de Paso de
Mensajes (MPI) para el paralelismo - ésta es una herramienta común en
los sistemas HPC.</p>
<div id="qué-es-mpi" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="qué-es-mpi" class="callout-inner">
<h3 class="callout-title">¿Qué es MPI?</h3>
<div class="callout-content">
<p>La interfaz de paso de mensajes es un conjunto de herramientas que
permiten que varias tareas que se ejecutan simultáneamente se comuniquen
entre sí. Normalmente, un único ejecutable se ejecuta varias veces,
posiblemente en máquinas diferentes, y las herramientas MPI se utilizan
para informar a cada instancia del ejecutable sobre sus procesos
hermanos y de qué instancia se trata. MPI también proporciona
herramientas que permiten la comunicación entre instancias para
coordinar el trabajo, intercambiar información sobre elementos de la
tarea o transferir datos. Una instancia MPI suele tener su propia copia
de todas las variables locales.</p>
</div>
</div>
</div>
<p>Mientras que los ejecutables compatibles con MPI pueden ejecutarse
generalmente como programas independientes, para que puedan ejecutarse
en paralelo deben utilizar un <em>entorno de ejecución MPI</em>, que es
una implementación específica del <em>estándar</em> MPI. Para activar el
entorno MPI, el programa debe iniciarse mediante una orden como
<code>mpiexec</code> (o <code>mpirun</code>, o <code>srun</code>, etc.
dependiendo del entorno de ejecución MPI que necesite utilizar), que
asegurará que se incluya el soporte de tiempo de ejecución apropiado
para el paralelismo.</p>
<div id="argumentos-de-ejecución-mpi" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="argumentos-de-ejecución-mpi" class="callout-inner">
<h3 class="callout-title">Argumentos de ejecución MPI</h3>
<div class="callout-content">
<p>Por sí solos, comandos como <code>mpiexec</code> pueden tomar muchos
argumentos que especifican cuántas máquinas participarán en la
ejecución, y puede que los necesite si desea ejecutar un programa MPI
por su cuenta (por ejemplo, en su portátil). En el contexto de un
sistema de colas, sin embargo, es frecuente que el tiempo de ejecución
MPI obtenga los parámetros necesarios del sistema de colas, examinando
las variables de entorno establecidas cuando se lanza el trabajo.</p>
</div>
</div>
</div>
<p>Modifiquemos el script de trabajo para solicitar más núcleos y
utilizar el tiempo de ejecución MPI.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cp serial-job.sh parallel-job.sh</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] nano parallel-job.sh</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat parallel-job.sh</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co">#SBATCH -J parallel-job</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#SBATCH -p cpubase_bycore_b1</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#SBATCH -N 1</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#SBATCH -n 4</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co"># Load the computing environment we need</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co"># (mpi4py and numpy are in SciPy-bundle)</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="ex">module</span> load Python</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="ex">module</span> load SciPy-bundle</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co"># Execute the task</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="ex">mpiexec</span> amdahl</span></code></pre>
</div>
<p>A continuación, envíe su trabajo. Tenga en cuenta que el comando de
envío no ha cambiado realmente con respecto a cómo enviamos el trabajo
serie: todos los ajustes paralelos están en el archivo por lotes en
lugar de en la línea de comandos.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch parallel-job.sh</span></code></pre>
</div>
<p>Como antes, utiliza los comandos de estado para comprobar cuándo se
ejecuta tu trabajo.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] ls <span class="at">-t</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>slurm-347178.out  parallel-job.sh  slurm-347087.out  serial-job.sh  amdahl  README.md  LICENSE.txt</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat slurm-347178.out</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Doing 30.000 seconds of 'work' on 4 processors,
which should take 10.875 seconds with 0.850 parallel proportion of the workload.

  Hello, World! I am process 0 of 4 on smnode1. I will do all the serial 'work' for 4.500 seconds.
  Hello, World! I am process 2 of 4 on smnode1. I will do parallel 'work' for 6.375 seconds.
  Hello, World! I am process 1 of 4 on smnode1. I will do parallel 'work' for 6.375 seconds.
  Hello, World! I am process 3 of 4 on smnode1. I will do parallel 'work' for 6.375 seconds.
  Hello, World! I am process 0 of 4 on smnode1. I will do parallel 'work' for 6.375 seconds.

Total execution time (according to rank 0): 10.888 seconds</code></pre>
</div>
<div id="es-4-más-rápido" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="es-4-más-rápido" class="callout-inner">
<h3 class="callout-title">¿Es 4× más rápido?</h3>
<div class="callout-content">
<p>El trabajo paralelo recibió 4× más procesadores que el trabajo en
serie: ¿significa eso que terminó en ¼ del tiempo?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Solución
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>El trabajo en paralelo tardó <em>menos</em> tiempo: ¡11 segundos es
mejor que 30! Pero sólo es una mejora de 2,7×, no de 4×.</p>
<p>Mira la salida del trabajo:</p>
<ul>
<li>Mientras el “proceso 0” hacía el trabajo en serie, los procesos del
1 al 3 hacían su trabajo en paralelo.</li>
<li>Mientras el proceso 0 se ponía al día en su trabajo paralelo, el
resto no hacía nada.</li>
</ul>
<p>El proceso 0 siempre tiene que terminar su tarea en serie antes de
poder empezar con el trabajo en paralelo. Esto establece un límite
inferior en la cantidad de tiempo que este trabajo va a tomar, no
importa cuántos núcleos que lanzar en él.</p>
<p>Este es el principio básico de la <a href="https://en.wikipedia.org/wiki/Amdahl's_law" class="external-link">Ley de Amdahl</a>,
que es una forma de predecir mejoras en el tiempo de ejecución para una
carga de trabajo <strong>fija</strong> que puede subdividirse y
ejecutarse en paralelo hasta cierto punto.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="cuánto-mejora-el-rendimiento-la-ejecución-en-paralelo">¿Cuánto mejora el rendimiento la ejecución en paralelo?<a class="anchor" aria-label="anchor" href="#cu%C3%A1nto-mejora-el-rendimiento-la-ejecuci%C3%B3n-en-paralelo"></a>
</h2>
<hr class="half-width">
<p>En teoría, dividir un cálculo perfectamente paralelo entre <em>n</em>
procesos MPI debería producir una disminución del tiempo total de
ejecución en un factor de <em>n</em>. Como acabamos de ver, los
programas reales necesitan cierto tiempo para que los procesos MPI se
comuniquen y coordinen, y algunos tipos de cálculos no pueden
subdividirse: sólo se ejecutan eficazmente en una única CPU.</p>
<p>Además, si los procesos MPI operan en diferentes CPUs físicas en el
ordenador, o a través de múltiples nodos de computación, se requiere
incluso más tiempo para la comunicación del que se necesita cuando todos
los procesos operan en una única CPU.</p>
<p>En la práctica, es habitual evaluar el paralelismo de un programa MPI
mediante</p>
<ul>
<li>ejecutar el programa en un rango de CPUs,</li>
<li>registrando el tiempo de ejecución en cada ejecución,</li>
<li>comparando cada tiempo de ejecución con el tiempo cuando se utiliza
una única CPU.</li>
</ul>
<p>Dado que “más es mejor” (la mejora es más fácil de interpretar a
partir de aumentos en alguna cantidad que de disminuciones), las
comparaciones se realizan utilizando el factor de aceleración
<em>S</em>, que se calcula como el tiempo de ejecución en una sola CPU
dividido por el tiempo de ejecución en varias CPU. Para un programa
perfectamente paralelo, un gráfico del aumento de velocidad <em>S</em>
frente al número de CPUs <em>n</em> daría una línea recta, <em>S</em> =
<em>n</em>.</p>
<p>Vamos a ejecutar un trabajo más, para que podamos ver lo cerca de una
línea recta que llega nuestro código <code>amdahl</code>.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] nano parallel-job.sh</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat parallel-job.sh</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="co">#SBATCH -J parallel-job</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co">#SBATCH -p cpubase_bycore_b1</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="co">#SBATCH -N 1</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co">#SBATCH -n 8</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="co"># Load the computing environment we need</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="co"># (mpi4py and numpy are in SciPy-bundle)</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="ex">module</span> load Python</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="ex">module</span> load SciPy-bundle</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="co"># Execute the task</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a><span class="ex">mpiexec</span> amdahl</span></code></pre>
</div>
<p>A continuación, envíe su trabajo. Tenga en cuenta que el comando de
envío no ha cambiado realmente con respecto a cómo enviamos el trabajo
serie: todos los ajustes paralelos están en el archivo por lotes en
lugar de en la línea de comandos.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sbatch parallel-job.sh</span></code></pre>
</div>
<p>Como antes, utiliza los comandos de estado para comprobar cuándo se
ejecuta tu trabajo.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] ls <span class="at">-t</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>slurm-347271.out  parallel-job.sh  slurm-347178.out  slurm-347087.out  serial-job.sh  amdahl  README.md  LICENSE.txt</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] cat slurm-347178.out</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>which should take 7.688 seconds with 0.850 parallel proportion of the workload.

  Hello, World! I am process 4 of 8 on smnode1. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 0 of 8 on smnode1. I will do all the serial 'work' for 4.500 seconds.
  Hello, World! I am process 2 of 8 on smnode1. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 1 of 8 on smnode1. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 3 of 8 on smnode1. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 5 of 8 on smnode1. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 6 of 8 on smnode1. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 7 of 8 on smnode1. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 0 of 8 on smnode1. I will do parallel 'work' for 3.188 seconds.

Total execution time (according to rank 0): 7.697 seconds</code></pre>
</div>
<div id="salida-no-lineal" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="salida-no-lineal" class="callout-inner">
<h3 class="callout-title">Salida no lineal</h3>
<div class="callout-content">
<p>Cuando ejecutamos el trabajo con 4 trabajadores paralelos, el trabajo
en serie escribió su salida primero, luego los procesos paralelos
escribieron su salida, con el proceso 0 llegando primero y último.</p>
<p>Con 8 trabajadores, este no es el caso: como los trabajadores
paralelos tardan menos que el trabajo en serie, es difícil decir qué
proceso escribirá su salida primero, ¡excepto que <em>no</em> será el
proceso 0!</p>
</div>
</div>
</div>
<p>Ahora, vamos a resumir la cantidad de tiempo que tardó cada trabajo
en ejecutarse:</p>
<table class="table">
<thead><tr class="header">
<th>Number of CPUs</th>
<th>Runtime (sec)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>30.033</td>
</tr>
<tr class="even">
<td>4</td>
<td>10.888</td>
</tr>
<tr class="odd">
<td>8</td>
<td>7.697</td>
</tr>
</tbody>
</table>
<p>Entonces, utilice la primera fila para calcular los speedups <span class="math inline">\(S\)</span>, utilizando Python como calculadora de
línea de comandos y la fórmula</p>
<p><span class="math display">\[ S(t_{n}) = \frac{t_{1}}{t_{n}}
\]</span></p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] for n in 30.033 10.888 7.697<span class="kw">;</span> <span class="cf">do</span> <span class="ex">python3</span> <span class="at">-c</span> <span class="st">"print(30.033 / </span><span class="va">$n</span><span class="st">)"</span><span class="kw">;</span> <span class="cf">done</span></span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>Number of CPUs</th>
<th>Speedup</th>
<th>Ideal</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td>4</td>
<td>2.75</td>
<td>4</td>
</tr>
<tr class="odd">
<td>8</td>
<td>3.90</td>
<td>8</td>
</tr>
</tbody>
</table>
<p>Los archivos de salida del trabajo nos han estado diciendo que este
programa está realizando el 85% de su trabajo en paralelo, dejando el
15% para ejecutarse en serie. Esto parece razonablemente alto, pero
nuestro rápido estudio del aumento de velocidad muestra que para obtener
un aumento de velocidad de 4×, tenemos que utilizar 8 o 9 procesadores
en paralelo. En los programas reales, el factor de aumento de velocidad
está influido por</p>
<ul>
<li>Diseño de la CPU</li>
<li>red de comunicación entre nodos de cálculo</li>
<li>Implementaciones de bibliotecas MPI</li>
<li>detalles del propio programa MPI</li>
</ul>
<p>Usando la Ley de Amdahl, puedes probar que con este programa es
<em>imposible</em> alcanzar 8× de velocidad, sin importar cuántos
procesadores tengas a mano. Los detalles de ese análisis, con resultados
que lo respalden, se dejan para la siguiente clase del taller HPC
Carpentry, <em>HPC Workflows</em>.</p>
<p>En un entorno HPC, intentamos reducir el tiempo de ejecución de todo
tipo de trabajos, y MPI es una forma extremadamente común de combinar
docenas, cientos o miles de CPUs en la resolución de un único problema.
Para aprender más sobre paralelización, vea la lección <a href="https://www.hpc-carpentry.org/hpc-parallel-novice/" class="external-link">parallel
novice lesson</a>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul>
<li>La programación paralela permite a las aplicaciones aprovechar las
ventajas del hardware paralelo.</li>
<li>El sistema de colas facilita la ejecución de tareas paralelas.</li>
<li>Las mejoras de rendimiento de la ejecución paralela no escalan
linealmente.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-18-resources"><p>Content from <a href="18-resources.html">Uso eficaz de los recursos</a></p>
<hr>
<p>Última actualización: 2025-08-04 |

        <a href="https://github.com/ocaisa/probable-pancake/edit/main/episodes/18-resources.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Tiempo estimado: <i aria-hidden="true" data-feather="clock"></i> 30 minutos</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo puedo revisar trabajos anteriores?</li>
<li>¿Cómo puedo utilizar estos conocimientos para crear un script de
envío más preciso?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<ul>
<li>Consulta las estadísticas de los trabajos.</li>
<li>Realiza peticiones de recursos más precisas en los scripts de
trabajo basándose en datos que describen el rendimiento pasado.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Hemos tocado todas las habilidades necesarias para interactuar con un
clúster HPC: iniciar sesión a través de SSH, cargar módulos de software,
enviar trabajos paralelos y encontrar la salida. Vamos a aprender a
estimar el uso de recursos y por qué puede ser importante.</p>
<section><h2 class="section-heading" id="estimación-de-recursos-requeridos-usando-el-planificador">Estimación de Recursos Requeridos Usando el Planificador<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-recursos-requeridos-usando-el-planificador"></a>
</h2>
<hr class="half-width">
<p>Aunque antes hemos cubierto la solicitud de recursos al planificador
con el código π, ¿cómo sabemos qué tipo de recursos necesitará el
software en primer lugar, y su demanda de cada uno? En general, a menos
que la documentación del software o los testimonios de los usuarios nos
den alguna idea, no sabremos cuánta memoria o tiempo de computación
necesitará un programa.</p>
<div id="leer-la-documentación" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="leer-la-documentación" class="callout-inner">
<h3 class="callout-title">Leer la documentación</h3>
<div class="callout-content">
<p>La mayoría de las instalaciones HPC mantienen documentación en forma
de wiki, sitio web o documento que se envía al registrarse para obtener
una cuenta. Echa un vistazo a estos recursos y busca el software que
piensas utilizar: puede que alguien haya escrito una guía para sacarle
el máximo partido.</p>
</div>
</div>
</div>
<p>Una forma conveniente de averiguar los recursos necesarios para que
un trabajo se ejecute con éxito es enviar un trabajo de prueba, y luego
preguntar al planificador sobre su impacto utilizando
<code>sacct -u yourUsername</code>. Puede utilizar este conocimiento
para configurar el siguiente trabajo con una estimación más cercana de
su carga en el sistema. Una buena regla general es pedir al programador
entre un 20% y un 30% más de tiempo y memoria de lo que espera que
necesite el trabajo. Esto garantiza que las pequeñas fluctuaciones en el
tiempo de ejecución o en el uso de memoria no provoquen la cancelación
del trabajo por parte del programador. Ten en cuenta que si pides
demasiado, puede que tu trabajo no se ejecute aunque haya suficientes
recursos disponibles, porque el programador estará esperando a que los
trabajos de otras personas terminen y liberen los recursos necesarios
para igualar lo que has pedido.</p>
</section><section><h2 class="section-heading" id="estadísticas">Estadísticas<a class="anchor" aria-label="anchor" href="#estad%C3%ADsticas"></a>
</h2>
<hr class="half-width">
<p>Como ya hemos enviado <code>amdahl</code> para que se ejecute en el
cluster, podemos consultar el planificador para ver cuánto tiempo ha
tardado nuestro trabajo y qué recursos se han utilizado. Usaremos
<code>sacct -u yourUsername</code> para obtener estadísticas sobre
<code>parallel-job.sh</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sacct <span class="at">-u</span> yourUsername</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
7               file.sh cpubase_b+ def-spons+          1  COMPLETED      0:0
7.batch           batch            def-spons+          1  COMPLETED      0:0
7.extern         extern            def-spons+          1  COMPLETED      0:0
8               file.sh cpubase_b+ def-spons+          1  COMPLETED      0:0
8.batch           batch            def-spons+          1  COMPLETED      0:0
8.extern         extern            def-spons+          1  COMPLETED      0:0
9            example-j+ cpubase_b+ def-spons+          1  COMPLETED      0:0
9.batch           batch            def-spons+          1  COMPLETED      0:0
9.extern         extern            def-spons+          1  COMPLETED      0:0</code></pre>
</div>
<p>Muestra todos los trabajos ejecutados hoy (tenga en cuenta que hay
varias entradas por trabajo). Para obtener información sobre un trabajo
específico (por ejemplo, 347087), cambiamos ligeramente el comando.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sacct <span class="at">-u</span> yourUsername <span class="at">-l</span> <span class="at">-j</span> 347087</span></code></pre>
</div>
<p>Mostrará mucha información; de hecho, cada pieza de información
recopilada sobre su trabajo por el planificador aparecerá aquí. Puede
ser útil redirigir esta información a <code>less</code> para facilitar
su visualización (utilice las teclas de flecha izquierda y derecha para
desplazarse por los campos).</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">[yourUsername@login1</span> ~] sacct <span class="at">-u</span> yourUsername <span class="at">-l</span> <span class="at">-j</span> 347087 <span class="kw">|</span> <span class="fu">less</span> <span class="at">-S</span></span></code></pre>
</div>
<div id="discusión" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="discusión" class="callout-inner">
<h3 class="callout-title">Discusión</h3>
<div class="callout-content">
<p>Esta vista puede ayudar a comparar la cantidad de tiempo solicitado y
realmente utilizado, la duración de la residencia en la cola antes del
lanzamiento, y la huella de memoria en el nodo(s) de computación.</p>
<p>¿Hasta qué punto fueron precisas nuestras estimaciones?</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="mejora-de-las-solicitudes-de-recursos">Mejora de las solicitudes de recursos<a class="anchor" aria-label="anchor" href="#mejora-de-las-solicitudes-de-recursos"></a>
</h2>
<hr class="half-width">
<p>A partir del historial de trabajos, vemos que los trabajos
<code>amdahl</code> terminaron de ejecutarse en unos pocos minutos como
máximo, una vez despachados. La estimación de tiempo que proporcionamos
en el script del trabajo era demasiado larga Esto hace que sea más
difícil para el sistema de colas estimar con precisión cuándo los
recursos quedarán libres para otros trabajos. En la práctica, esto
significa que el sistema de colas espera para despachar nuestro trabajo
<code>amdahl</code> hasta que se abre todo el espacio de tiempo
solicitado, en lugar de “colarlo” en una ventana mucho más corta en la
que el trabajo podría realmente terminar. Especificar el tiempo de
ejecución esperado en el script de envío con mayor precisión ayudará a
aliviar la congestión del cluster y puede conseguir que su trabajo se
despache antes.</p>
<div id="reducir-la-estimación-de-tiempo" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="reducir-la-estimación-de-tiempo" class="callout-inner">
<h3 class="callout-title">Reducir la estimación de tiempo</h3>
<div class="callout-content">
<p>Edita <code>parallel_job.sh</code> para establecer una mejor
estimación del tiempo. ¿Qué tan cerca puedes estar?</p>
<p>Sugerencia: utilice <code>-t</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Solución
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>La siguiente línea indica a Slurm que nuestro trabajo debe terminar
en 2 minutos:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#SBATCH -t 00:02:00</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul>
<li>La precisión de los guiones de trabajo ayuda al sistema de colas a
asignar eficazmente los recursos compartidos.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-19-responsibility"><p>Content from <a href="19-responsibility.html">Uso responsable de los recursos compartidos</a></p>
<hr>
<p>Última actualización: 2025-08-04 |

        <a href="https://github.com/ocaisa/probable-pancake/edit/main/episodes/19-responsibility.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Tiempo estimado: <i aria-hidden="true" data-feather="clock"></i> 20 minutos</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul>
<li>¿Cómo puedo ser un usuario responsable?</li>
<li>¿Cómo puedo proteger mis datos?</li>
<li>¿Cuál es la mejor forma de obtener grandes cantidades de datos de un
sistema HPC?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<ul>
<li>Describe cómo las acciones de un único usuario pueden afectar a la
experiencia de otros en un sistema compartido.</li>
<li>Discutir el comportamiento de un ciudadano considerado del sistema
compartido.</li>
<li>Explica la importancia de hacer copias de seguridad de los datos
críticos.</li>
<li>Describa los retos que plantea la transferencia de grandes
cantidades de datos fuera de los sistemas HPC.</li>
<li>Convierte muchos ficheros en un único archivo comprimido utilizando
tar.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Una de las principales diferencias entre utilizar recursos HPC
remotos y tu propio sistema (por ejemplo, tu portátil) es que los
recursos remotos se comparten. El número de usuarios que comparten el
recurso en un momento dado varía de un sistema a otro, pero es poco
probable que usted sea el único usuario conectado o utilizando un
sistema de este tipo.</p>
<p>El uso generalizado de sistemas de programación en los que los
usuarios envían trabajos a recursos HPC es un resultado natural de la
naturaleza compartida de estos recursos. Hay otras cosas que usted, como
miembro honrado de la comunidad, debe tener en cuenta.</p>
<section><h2 class="section-heading" id="sea-amable-con-los-nodos-de-inicio-de-sesión">Sea amable con los nodos de inicio de sesión<a class="anchor" aria-label="anchor" href="#sea-amable-con-los-nodos-de-inicio-de-sesi%C3%B3n"></a>
</h2>
<hr class="half-width">
<p>El nodo de inicio de sesión suele estar ocupado gestionando todos los
usuarios conectados, creando y editando archivos y compilando software.
Si la máquina se queda sin memoria o capacidad de procesamiento, se
volverá muy lenta e inutilizable para todos. Aunque la máquina está
pensada para ser utilizada, asegúrate de hacerlo de forma responsable,
de manera que no afecte negativamente a la experiencia de los demás
usuarios.</p>
<p>Los nodos de inicio de sesión son siempre el lugar adecuado para
lanzar trabajos. Las políticas de clúster varían, pero también pueden
utilizarse para probar flujos de trabajo y, en algunos casos, pueden
albergar herramientas avanzadas de depuración o desarrollo específicas
del clúster. El cluster puede tener módulos que necesitan ser cargados,
posiblemente en un cierto orden, y rutas o versiones de librerías que
difieren de tu portátil, y hacer una prueba interactiva en el nodo
principal es una forma rápida y fiable de descubrir y arreglar estos
problemas.</p>
<div id="los-nodos-de-inicio-de-sesión-son-un-recurso-compartido" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="los-nodos-de-inicio-de-sesión-son-un-recurso-compartido" class="callout-inner">
<h3 class="callout-title">Los nodos de inicio de sesión son un recurso compartido</h3>
<div class="callout-content">
<p>Recuerda que el nodo de inicio de sesión se comparte con todos los
demás usuarios y tus acciones podrían causar problemas a otras personas.
Piensa detenidamente en las posibles implicaciones de emitir comandos
que puedan utilizar grandes cantidades de recursos.</p>
<p>¿No está seguro? Pregunte a su amable administrador de sistemas
(“sysadmin”) si lo que está contemplando es adecuado para el nodo de
inicio de sesión, o si existe otro mecanismo para hacerlo de forma
segura.</p>
</div>
</div>
</div>
<p>Siempre puede utilizar los comandos <code>top</code> y
<code>ps ux</code> para listar los procesos que se están ejecutando en
el nodo de inicio de sesión junto con la cantidad de CPU y memoria que
están utilizando. Si esta comprobación revela que el nodo de inicio de
sesión está algo inactivo, puede utilizarlo con seguridad para su tarea
de procesamiento no rutinaria. Si algo va mal – el proceso tarda
demasiado, o no responde – puede usar el comando <code>kill</code> junto
con el <em>PID</em> para terminar el proceso.</p>
<div id="etiqueta-del-nodo-de-inicio-de-sesión" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="etiqueta-del-nodo-de-inicio-de-sesión" class="callout-inner">
<h3 class="callout-title">Etiqueta del nodo de inicio de sesión</h3>
<div class="callout-content">
<p>¿Cuál de estos comandos sería una tarea rutinaria a ejecutar en el
nodo login?</p>
<ol style="list-style-type: decimal">
<li><code>python physics_sim.py</code></li>
<li><code>make</code></li>
<li><code>create_directories.sh</code></li>
<li><code>molecular_dynamics_2</code></li>
<li><code>tar -xzf R-3.3.0.tar.gz</code></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Solución
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Construir software, crear directorios y desempaquetar software son
tareas &gt; comunes y aceptables para el nodo de inicio de sesión: las
opciones #2 (<code>make</code>), #3 (<code>mkdir</code>) y #5
(<code>tar</code>) probablemente estén bien. Tenga en cuenta que los
nombres de los scripts no siempre reflejan su contenido: antes de lanzar
#3, por favor <code>less create_directories.sh</code> y asegúrese de que
no es un troyano.</p>
<p>No está bien visto ejecutar aplicaciones que consumen muchos
recursos. A menos que esté seguro de que no afectará a otros usuarios,
no ejecute trabajos como #1 (<code>python</code>) o #4 (código MD
personalizado). Si no está seguro, pida consejo a su administrador de
sistemas.</p>
</div>
</div>
</div>
</div>
<p>Si experimenta problemas de rendimiento con un nodo de inicio de
sesión, debe informar de ello al personal del sistema (normalmente a
través del servicio de asistencia) para que lo investiguen.</p>
</section><section><h2 class="section-heading" id="prueba-antes-de-escalar">Prueba antes de escalar<a class="anchor" aria-label="anchor" href="#prueba-antes-de-escalar"></a>
</h2>
<hr class="half-width">
<p>Recuerde que generalmente se le cobra por el uso en sistemas
compartidos. Un simple error en un script de trabajo puede acabar
costando una gran cantidad de presupuesto de recursos. Imagina un script
de trabajo con un error que hace que se quede sin hacer nada durante 24
horas en 1000 núcleos o uno en el que has solicitado 2000 núcleos por
error y ¡sólo utilizas 100 de ellos! Este problema puede agravarse
cuando la gente escribe scripts que automatizan el envío de trabajos
(por ejemplo, cuando se ejecuta el mismo cálculo o análisis sobre muchos
parámetros o archivos diferentes). Cuando esto ocurre, te perjudica
tanto a ti (ya que desperdicias muchos recursos cargados) como a otros
usuarios (que ven bloqueado su acceso a los nodos de cálculo ociosos).
En recursos muy ocupados puedes esperar muchos días en una cola para que
tu trabajo falle a los 10 segundos de empezar debido a un error
tipográfico trivial en el script del trabajo. Esto es extremadamente
frustrante</p>
<p>La mayoría de los sistemas proporcionan recursos dedicados para
pruebas que tienen tiempos de espera cortos para ayudarte a evitar este
problema.</p>
<div id="probar-scripts-de-envío-de-trabajos-que-utilizan-grandes-cantidades-de-recursos" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="probar-scripts-de-envío-de-trabajos-que-utilizan-grandes-cantidades-de-recursos" class="callout-inner">
<h3 class="callout-title">Probar scripts de envío de trabajos que utilizan grandes cantidades de recursos</h3>
<div class="callout-content">
<p>Antes de enviar una gran cantidad de trabajos, envíe primero uno como
prueba para asegurarse de que todo funciona como se espera.</p>
<p>Antes de enviar un trabajo muy grande o muy largo envíe una pequeña
prueba truncada para asegurarse de que el trabajo se inicia como se
espera.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="tener-un-plan-de-copias-de-seguridad">Tener un plan de copias de seguridad<a class="anchor" aria-label="anchor" href="#tener-un-plan-de-copias-de-seguridad"></a>
</h2>
<hr class="half-width">
<p>Aunque muchos sistemas HPC guardan copias de seguridad, no siempre
cubren todos los sistemas de ficheros disponibles y puede que sólo sean
para fines de recuperación de desastres (es decir, para restaurar todo
el sistema de ficheros en caso de pérdida en lugar de un fichero o
directorio individual que hayas borrado por error). Proteger los datos
críticos de la corrupción o el borrado es principalmente tu
responsabilidad: mantén tus propias copias de seguridad.</p>
<p>Los sistemas de control de versiones (como Git) suelen tener ofertas
gratuitas basadas en la nube (por ejemplo, GitHub y GitLab) que se
utilizan generalmente para almacenar el código fuente. Incluso si no
estás escribiendo tus propios programas, estos pueden ser muy útiles
para almacenar scripts de trabajo, scripts de análisis y pequeños
archivos de entrada.</p>
<p>Si está creando software, es posible que tenga una gran cantidad de
código fuente que compila para crear su ejecutable. Dado que estos datos
generalmente se pueden recuperar volviendo a descargar el código o
volviendo a ejecutar la operación de comprobación desde el repositorio
de código fuente, también es menos importante proteger estos datos.</p>
<p>Para grandes cantidades de datos, especialmente resultados
importantes de sus ejecuciones, que pueden ser irremplazables, debe
asegurarse de que dispone de un sistema robusto para sacar copias de los
datos del sistema HPC siempre que sea posible a un almacenamiento de
copia de seguridad. Herramientas como <code>rsync</code> pueden ser muy
útiles para esto.</p>
<p>Su acceso al sistema HPC compartido estará generalmente limitado en
el tiempo, por lo que debe asegurarse de tener un plan para transferir
sus datos fuera del sistema antes de que termine su acceso. No subestime
el tiempo necesario para transferir grandes cantidades de datos y
asegúrese de planificarlo con suficiente antelación (idealmente, antes
de empezar a utilizar el sistema para su investigación).</p>
<p>En todos estos casos, el servicio de asistencia del sistema que esté
utilizando debería poder proporcionarle orientación útil sobre las
opciones de transferencia de datos para los volúmenes de datos que vaya
a utilizar.</p>
<div id="tus-datos-son-tu-responsabilidad" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tus-datos-son-tu-responsabilidad" class="callout-inner">
<h3 class="callout-title">Tus datos son tu responsabilidad</h3>
<div class="callout-content">
<p>Asegúrate de que entiendes cuál es la política de copias de seguridad
de los sistemas de archivos del sistema que estás utilizando y qué
implicaciones tiene para tu trabajo si pierdes tus datos en el sistema.
Planifica tus copias de seguridad de los datos críticos y cómo
transferirás los datos fuera del sistema a lo largo del proyecto.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="transfiriendo-datos">Transfiriendo datos<a class="anchor" aria-label="anchor" href="#transfiriendo-datos"></a>
</h2>
<hr class="half-width">
<p>Como se mencionó anteriormente, muchos usuarios se encuentran con el
reto de transferir grandes cantidades de datos fuera de los sistemas HPC
en algún momento (esto es más frecuente en la transferencia de datos
fuera que dentro de los sistemas, pero los consejos a continuación se
aplican en ambos casos). La velocidad de transferencia de datos puede
estar limitada por muchos factores diferentes, por lo que el mejor
mecanismo de transferencia de datos que se puede utilizar depende del
tipo de datos que se transfieren y a dónde van los datos.</p>
<p>Los componentes entre el origen y el destino de tus datos tienen
diferentes niveles de rendimiento y, en particular, pueden tener
diferentes capacidades con respecto al <strong>ancho de banda</strong> y
la <strong>latencia</strong>.</p>
<p><strong>El ancho de banda</strong> es generalmente la cantidad bruta
de datos por unidad de tiempo que un dispositivo es capaz de transmitir
o recibir. Es una métrica común y generalmente bien entendida.</p>
<p><strong>La latencia</strong> es algo más sutil. Para las
transferencias de datos, se puede considerar como la cantidad de tiempo
que se tarda en sacar los datos del almacenamiento y ponerlos en una
forma transmisible. Los problemas de latencia son la razón por la que es
aconsejable ejecutar las transferencias de datos moviendo un pequeño
número de archivos grandes, en lugar de lo contrario.</p>
<p>Algunos de los componentes clave y sus problemas asociados son:</p>
<ul>
<li>
<strong>Velocidad del disco</strong>: Los sistemas de archivos de
los sistemas HPC suelen ser altamente paralelos y constan de un gran
número de unidades de disco de alto rendimiento. Esto les permite
soportar un ancho de banda de datos muy elevado. A menos que el sistema
remoto tenga un sistema de ficheros paralelo similar, la velocidad de
transferencia puede verse limitada por el rendimiento del disco en ese
extremo.</li>
<li>
<strong>Rendimiento de los metadatos</strong>: <em>Las operaciones
de metadatos</em>, como abrir y cerrar archivos o listar el propietario
o el tamaño de un archivo, son mucho menos paralelas que las operaciones
de lectura/escritura. Si tus datos consisten en un gran número de
archivos pequeños, puede que la velocidad de transferencia se vea
limitada por las operaciones de metadatos. Las operaciones de metadatos
realizadas por otros usuarios del sistema también pueden interactuar
fuertemente con las que tú realizas, por lo que reducir el número de
operaciones de este tipo que utilizas (combinando varios archivos en uno
solo) puede reducir la variabilidad en tus tasas de transferencia y
aumentar la velocidad de transferencia.</li>
<li>
<strong>Velocidad de red</strong>: El rendimiento de la
transferencia de datos puede verse limitado por la velocidad de la red.
Más importante aún, está limitado por la sección más lenta de la red
entre el origen y el destino. Si está transfiriendo a su ordenador
portátil/estación de trabajo, es probable que ésta sea su conexión (ya
sea a través de LAN o WiFi).</li>
<li>
<strong>Velocidad del cortafuegos</strong>: La mayoría de las redes
modernas están protegidas por algún tipo de cortafuegos que filtra el
tráfico malicioso. Este filtrado tiene cierta sobrecarga y puede reducir
el rendimiento de la transferencia de datos. Las necesidades de una red
de uso general que aloja servidores web o de correo electrónico y
equipos de sobremesa son muy distintas de las de una red de
investigación que necesita transferir grandes volúmenes de datos. Si
intentas transferir datos a o desde un host en una red de propósito
general, puede que el cortafuegos de esa red limite la velocidad de
transferencia que puedes alcanzar.</li>
</ul>
<p>Como se ha mencionado anteriormente, si tienes datos relacionados que
consisten en un gran número de archivos pequeños, se recomienda
encarecidamente empaquetar los archivos en un archivo <em>archive</em>
más grande para su almacenamiento y transferencia a largo plazo. Un
único archivo grande hace un uso más eficiente del sistema de archivos y
es más fácil de mover, copiar y transferir porque se requieren muchas
menos operaciones de metadatos. Los ficheros de archivo pueden crearse
con herramientas como <code>tar</code> y <code>zip</code>. Ya conocimos
<code>tar</code> cuando hablamos anteriormente de la transferencia de
datos.</p>
<p>¡<a href="../fig/responsibility-bandwidth.svg" max-width="90%" alt="Esquema del ancho de banda de la red">Diagrama esquemático de ancho
de banda y latencia para E/S de disco y red. Cada uno de los componentes
de la figura está conectado por una línea azul de anchura proporcional
al ancho de banda de la interfaz. Los pequeños laberintos en los puntos
de enlace ilustran la latencia del enlace, con laberintos más tortuosos
que indican una latencia mayor.</a></p>
<div id="considere-la-mejor-forma-de-transferir-datos" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="considere-la-mejor-forma-de-transferir-datos" class="callout-inner">
<h3 class="callout-title">Considere la mejor forma de transferir datos</h3>
<div class="callout-content">
<p>Si vas a transferir grandes cantidades de datos, tendrás que pensar
en qué puede afectar al rendimiento de la transferencia. Siempre es útil
realizar algunas pruebas que puedas utilizar para extrapolar el tiempo
que tardará la transferencia de tus datos.</p>
<p>Supongamos que tienes una carpeta “data” que contiene unos 10.000
archivos, una buena mezcla de pequeños y grandes datos ASCII y binarios.
¿Cuál de las siguientes opciones sería la mejor para transferirlos a HPC
Carpentry’s Cloud Cluster?</p>
<ol style="list-style-type: decimal">
<li><p><code>scp -r data yourUsername@cluster.hpc-carpentry.org:~/</code></p></li>
<li><p><code>rsync -ra data yourUsername@cluster.hpc-carpentry.org:~/</code></p></li>
<li><p><code>rsync -raz data yourUsername@cluster.hpc-carpentry.org:~/</code></p></li>
<li>
<p><code>tar -cvf data.tar data;</code></p>
<p><code>rsync -raz data.tar yourUsername@cluster.hpc-carpentry.org:~/</code></p>
</li>
<li>
<p><code>tar -cvzf data.tar.gz data;</code></p>
<p><code>rsync -ra data.tar.gz yourUsername@cluster.hpc-carpentry.org:~/</code></p>
</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Solución
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<code>scp</code> copiará recursivamente el directorio. Esto
funciona, pero sin compresión.</li>
<li>
<code>rsync -ra</code> funciona como <code>scp -r</code>, pero
conserva la información del archivo, como las horas de creación. Esto es
ligeramente mejor.</li>
<li>
<code>rsync -raz</code> añade compresión, lo que ahorrará algo de
ancho de banda. Si tienes una CPU potente en ambos extremos de la línea,
y estás en una red lenta, ésta es una buena opción.</li>
<li>Este comando utiliza primero <code>tar</code> para unir todo en un
único archivo, y luego <code>rsync -z</code> para transferirlo con
compresión. Con este <em>número</em> tan grande de ficheros, la
sobrecarga de metadatos puede dificultar la transferencia, por lo que es
una buena idea.</li>
<li>Este comando utiliza <code>tar -z</code> para comprimir el archivo y
luego <code>rsync</code> para transferirlo. Puede tener un rendimiento
similar a #4, pero en la mayoría de los casos (para grandes conjuntos de
datos), es la mejor combinación de alto rendimiento y baja latencia
(aprovechando al máximo el tiempo y la conexión de red).</li>
</ol>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul>
<li>Ten cuidado con el uso del nodo login.</li>
<li>Tus datos en el sistema son tu responsabilidad.</li>
<li>Planifica y prueba grandes transferencias de datos.</li>
<li>A menudo es mejor convertir muchos ficheros en un único archivo
antes de transferirlos.</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>Esta lección está sujeta al <a href="CODE_OF_CONDUCT.html">Código de Conducta</a></p>
        <p>

        <a href="https://github.com/ocaisa/probable-pancake/edit/main/README.md" class="external-link">Editar en GitHub</a>

	
        | <a href="https://github.com/ocaisa/probable-pancake/blob/main/CONTRIBUTING.md" class="external-link">Contribuir</a>
        | <a href="https://github.com/ocaisa/probable-pancake/" class="external-link">Fuente</a></p>
				<p><a href="https://github.com/ocaisa/probable-pancake/blob/main/CITATION" class="external-link">Cita</a> | <a href="mailto:team@carpentries.org">Contacto</a> | <a href="https://carpentries.org/about/" class="external-link">Acerca de</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Plantilla compartida bajo <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> por <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Construido con <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a> y <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Volver al inicio"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Volver</span> al inicio
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://ocaisa.github.io/probable_pancake/instructor/aio.html",
  "inLanguage": "es",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Todo en una sola página",
  "creativeWorkStatus": "active",
  "url": "https://ocaisa.github.io/probable_pancake/instructor/aio.html",
  "identifier": "https://ocaisa.github.io/probable_pancake/instructor/aio.html",
  "dateCreated": "2017-03-24",
  "dateModified": "2025-08-04",
  "datePublished": "2025-08-04"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

